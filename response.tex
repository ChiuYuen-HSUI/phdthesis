% !arara: clean: { files: [response.aux, response.log, response.bbl, response.blg] }
% arara: xelatex: {synctex : yes}
% arara: biber
% arara: xelatex: {synctex : yes}
\documentclass{responseletter}
\date{\today}

\setkomavar{fromname}{Egon Geerardyn \showinitial{EG}}
\setkomavar{fromemail}[]{egon.geerardyn@vub.ac.be} 

\newcommand{\commit}[1]{\href{https://github.com/egeerardyn/phdthesis/commit/#1}{\texttt{#1}}}

\addbibresource{biblio/ownWork.bib}
\addbibresource{biblio/references.bib} 

\begin{document}
\begin{letter}{%
Bart Peeters \showinitial{BP}\\
Johan Deconinck \showinitial{JD}\\
Johan Schoukens \showinitial{JS}\\
Jérôme Antoni \showinitial{JA}\\
Koen Tiels \showinitial{KT}\\
Patrick Guillaume \showinitial{PG}\\
Tom Oomen \showinitial{TO}\\
Tomas McKelvey \showinitial{TM}
}

\opening{Dear jury members,}

First of all, I would like to thank you for your feedback on my PhD thesis and the ensuing discussions.
This has greatly improved the text.

Attached, you can find an extensive summary of the changes I have carried out in the text.
\oldnew{old}{new}
The numbers in the margin indicate the pages in the old revision (\href{https://github.com/egeerardyn/phdthesis/releases/tag/private-submit}{\texttt{946aebc}} as for the private defense) and in the new revision.

I have also made the \LaTeX{} source code of my text (and data files) available on GitHub.
There, you can inspect the \href{https://github.com/egeerardyn/phdthesis/compare/b6b273e...master}{full set of changes} at the source code level, or \href{https://github.com/egeerardyn/phdthesis/commits/master}{inspect individual changes}.

\closing{Sincerely,}
\encl{list of changes\\
          \href{https://dl.dropboxusercontent.com/u/452005/VUB/phd/old.pdf}{\color{old}old manuscript}\\
          \href{https://dl.dropboxusercontent.com/u/452005/VUB/phd/new.pdf}{\color{new}new manuscript}\\}%FIXME: upload manuscript to dropbox
\end{letter}


\section{Requested Changes}

\subsection{Figures}
\question{Increase the line width used in the figures like Figure 3.4.\\}
\action{All figures have been inspected and improved. At most places, the minimum line width has been increased to $0.75\mathrm{pt}$. At some places, markers and annotations have been added to easy identification of the different graphs.}

\subsection{Assumptions}
\question{Make a list of assumptions, especially in Chapter 2, under which the work is valid}

\begin{enumerate}

\item
\action{Assumptions have been added to chapter 2.}
\begin{oldquote}
For the theoretical analysis, we consider \gls{SISO} \gls{OE} systems, i.e.
\begin{align}
y(t) &=G(s,\theta)u(t)  + H(s,\vartheta)e(t),
\end{align}
where $u(t)$ is a known input sequence, $y(t)$ the output sequence, and $e(t)$ is zero mean Gaussian white noise with variance $\sigma_{e}^2$.
$G$ is a rational, time-invariant transfer function in continuous time.
\end{oldquote}
\begin{newquote}
\oldnewpage{33}{?}
For the theoretical analysis, we consider \gls{SISO} \gls{OE} systems, i.e.
\begin{align}
y(t) &=G(s,\theta)u(t)  + H(s,\vartheta)e(t),
\end{align}
where $u(t)$ is a known input sequence, $y(t)$ the output sequence, and $e(t)$ is zero mean Gaussian white noise with variance $\sigma_{e}^2$.
$G$ and $H$ are rational, time-invariant transfer function in continuous time.
\omission{}
\begin{assumption}{2.1}
The noise filter $H(s,\vartheta)$ is assumed to be independently parametrized from the plant $G(s,\theta)$, i.e. $\vartheta$ and $\theta$ are independent.
\end{assumption}
\begin{assumption}{2.2}
For the derivations, $H(s,\vartheta) = 1$ is used as a working assumption such that the disturbing noise on the output is zero mean Gaussian white noise.
When this assumption is violated, one has to first measure the noise coloring and use this knowledge to predistort the input to account for the noise coloring.
\end{assumption}
\end{newquote}

\item \says{TM}{In the thesis, the focus is on resonant systems. It would be good to add some comments in perspective of a general system identification.}
\TODO{discuss this}
\item \says{JA}{Here, the number of modes per frequency band decreases as the frequency increases. A decreasing modal density is typical for a beam, but for a plate, the number of modes is constant. For a volume, the number of modes increases. I suggest to recast the context in a set of assumptions. The modal density and the modal overlap factor are important in this respect.
But this also opens perspectives. For a beam, you would get a logarithmic multisine, for a plate, you would get a linear multisine. In mechanics, you have an idea about the modal density and modal overlap factor, which can be a big prior knowledge.}
\action{The following remarks have been added}

\begin{newquote}
\oldnewpage{}{?}
\begin{assumption} {2.3}
The sub-systems in (2.33) all are either lightly damped ($\damping \ll \sqrt{1/2}$) or are not of interest.
\end{assumption}

\begin{assumption}{2.4}
The resonance frequencies $\wn[i]$ of all the sub-systems in (2.33) are well-separated in the frequency domain such that there is little modal overlap, i.e. $\modalOverlap \ll 1$.
\end{assumption}

\begin{assumption}{2.5}
It is assumed that the excitation signal contains many more frequency lines than parameters required to describe the system under test well.
Hence, we can neglect the bias of the estimate and focus on its variance error by assuming that a proper model order can be chosen and fitted from the data.
\end{assumption}

\begin{remark}{2.3}
The modal overlap $\modalOverlap$ is given~\citep{Ege2009} as the ratio of the average $3\unit{dB}$ bandwidth to the average difference in resonance frequencies for all resonances in the frequency band of interest.
Often, the modal overlap is linked to the model density $\modalOverlap(\omega) = \wdB \modalDensity{\omega}$.
In acoustic and structural engineering, expressions exist for the theoretical modal density $\modalDensity{f}$ in specific geometries such as beams, plates, square volumes~\citep{Hart1971,Bies2009}.
Specifically, beams exhibit a modal density $\modalDensity{\omega} = \bigO{\omega^{-1/2}}$, for plates this becomes $\modalDensity{\omega} = \bigO{1}$, and for volumes $\modalDensity{\omega} = \bigO{\omega}$.
As such, the previous assumption practically limits the use of the excitation signals to beams or the low-frequency region of plates and volumes~\citep{Ege2009}.
\end{remark}
\end{newquote}
\begin{newquote}
\oldnewpage{}{?}
\begin{remark}{2.14}
The proposed design can be adapted quite straightforwardly to also account for the high-frequency regions of e.g. plates by increasing the number of frequency lines where the modal overlap becomes more important.
In practice, this will boil down to linearly spaced multisines.
For measurement of the transfer characteristics of volumes (e.g. rooms), more specialized techniques are required to describe the high-frequency behavior such as the ones discussed by \citet{Ege2009}.
\end{remark}
\end{newquote}

\item \says{JA}{In (2.12), you have a series of second-order systems that all have the same amplitude. Can this be made more general?}
\action{The following remark has been added}
\begin{newquote}
 The free parameters $(\dc, \damping, \wn, \wz)$ of the sub-system are reduced to only $(\damping, \wn)$ and the others are fixed during our experiments: $\dc = 1$ and $\wz \to \infty$. 
   \begin{remark}{2.10}
   Implicitly, this considers a design where each of the sub-systems have an equal gain $\dc=1$ and residue $\wz \to\infty$.
   In practice, this is often not a reasonable assumption, but the design can be adapted in a straightforward manner.
   Concretely, using a first experiment with the proposed signal, one can estimate the different parameters of the sub-systems and optimize the amplitude spectrum of the signal to take those into account: for sub-systems where $\dc$ is lower than on average, the amplitude spectrum needs to be increased near the resonance frequency and \latin{vice versa}.
   \end{remark}
\end{newquote}

\item \says{JA}{On page 33, in (2.62), you have a covariance matrix. The PSD of the noise depends on the frequency. Afterwards, it is assumed constant?}
\says{KT}{For the input design, in (2.1), you assume that the noise is white. What happens for colored noise? The reason I ask this is in case you want to estimate the best linear approximation of a nonlinear system. Then you can consider the stochastic nonlinear distortions as a noise source, but that is not necessarily white.}
\action{This is addressed in Assumption 2.2 and in the following remark that has been added to the manuscript}
\oldnewpage{33}{?}
\begin{newquote}
To introduce only limited prior knowledge into the input design, we shall assume that the noise is white.
  Hence, $\sigma^2_E(\omega) = \sigma^2_E$ is constant over the whole frequency band of interest.
  If the noise coloring is known beforehand (or measured in a previous experiment), the design can be adapted in a straightforward manner, e.g. by coloring the amplitude spectrum accordingly.
\end{newquote}

  \item \says{TM}{For the robust excitation signals, you use the setup of Goodwin and coworkers. On slide 17, you focus on variance. Why not on bias?}
               \says{TM}{Why can you guarantee \replace{that}{unbiasedness of your estimators}?}
               \action{This has been addressed in Assumption 2.5 (see above)}
\end{enumerate}

\subsection{References}
\question{Update the (historical) references.}
\begin{enumerate}
\item 
\oldnewpage{51}{?}
\says{TM}{In Chapter~3: Did the problem of FRF modeling start in 1995? How long does the problem date back?  I would suggest to add a few historical references, older than 1995.}
 \action{References have been added to Chapter 3. The original editions of e.g. \citep{Bendat2010,Bendat1993,Box2008} date back to somewhere between the 1950s and 1980s, but I have opted to refer to the last editions.}
\begin{oldquote}
The measurement of \glspl{FRF} of dynamic systems is an important step in many technical applications, often used as a simple visualization of the system dynamics.
However, obtaining a good non-parametric \gls{FRF} from a measured input-output data set can be challenging due to the presence of noise, leakage and measurement time limitations to observe lightly-damped dynamics well.
\gls{FRF} measurement techniques are discussed, for instance, in
\citep{Schoukens1998,Schoukens2006LPM,Guillaume1996,Broersen1995,Pintelon2010LPM1,Antoni2007FRF,Pintelon2012}, and applied to practical devices and systems~\citep{Lim2010,Robinson1990,Behjat2010}, among others.
\end{oldquote}
\begin{newquote}
The measurement of \glspl{FRF} of dynamic systems is an important step in many technical applications, often used as a simple visualization of the system dynamics.
However, obtaining a good non-parametric \gls{FRF} from a measured input-output data set can be challenging due to the presence of noise, leakage and measurement time limitations to observe lightly-damped dynamics well.
\gls{FRF} measurement techniques are discussed, for instance, in
\citep{Schoukens1998,Schoukens2006LPM,Guillaume1996,Broersen1995,Pintelon2010LPM1,Antoni2007FRF,Pintelon2012,Bendat2010,Bendat1993,Jenkins1968,Box2008,Bendat1978,Blackman1959}, and applied to practical devices and systems~\citep{Lim2010,Robinson1990,Behjat2010,White1969}, among others.
\end{newquote}

\item 
\oldnewpage{119}{?}
\says{TM}{The initialization of the parametric estimators is an interesting expos\'e. The references have a narrow flavor. There are more people that worked on this, other than Ljung.}
\action{More (historical) references for parametric estimates and initial values have been added.}
\begin{oldquote}
Parametric identification of \gls{LTI} systems from either input/output data or non-parametric frequency response data, has been well developed as evidenced by published literature~\citep{Pintelon2012,Ljung1999,Schoukens1999,Pintelon1998}.
\end{oldquote}
\begin{newquote}
Parametric identification of \gls{LTI} systems from either input/output data or non-parametric frequency response data, has been well developed as evidenced by published literature~\citep{Pintelon2012,Ljung1999,Schoukens1999,Pintelon1998,Soderstrom1989,Goodwin1977,Brillinger1981,Sanathanan1963,McKelvey2002,}.
\end{newquote}
\end{enumerate}


\subsection{Define robustness}
\question{Define robustness.}

\begin{enumerate}
  \item \says{JA}{The use of the word ``robustness'' can have different meanings. What is the meaning of ``robustness of input''?}
  \says{JA}{I suggest that you define ``robustness'' in the thesis.}
  \action{Robustness has been defined in the introduction of chapter 2}
  \oldnewpage{}{?}
  \begin{newquote}
  In short, we consider an input signal to be \term{robust}, if such signal allows one to measure the \gls{FRF} of a wide variety of systems well, without requiring a lot of specific prior information regarding the system.
Moreover, a robust input signal should not be very sensitive towards assumptions regarding the system under test (or should be easily adaptable if the assumptions are only approximately valid).
  \end{newquote}
\end{enumerate}

\subsection{Small Corrections}
\question{A list of small corrections will be provided directly by the members of the jury.}

\begin{enumerate}

\item \action{A lot of typos have been fixed and other tiny adjustments have been carried out.}
You can consult commits
  \commit{eed3f40}, 
  \commit{b163710}, 
  \commit{08d2bfb},  
  \commit{dc1d99d}, 
  \commit{06471dd}, 
  \commit{d4771ea}, and
  \commit{ca38442} where most of these small changes are contained.

\item \action{The bibliography has been made more uniform. Whenever possible, first names have been included.}

\item \says{TM}{When considering unstable LTI systems, which methods will make sense when doing truncation?}
\answer{The truncation methods are not directly usable for that situation.}
\action{A short discussion has been added to the future work section.}
\oldnewsection{}{6.2.2}
\begin{newquote}
    With respect to the impulse response truncation approaches introduced in Section~3.6, a few paths could be investigated further to broaden the class of systems where these methods are applicable and have a more subtle smoothing behavior of the transfer function.

    The crude truncation approach that is discussed in this thesis, can be interpreted as equivalent to windowing the \gls{IRF} with a rectangular window.
    In the frequency domain, this causes a very obvious correlation in the \gls{FRF}.
    By choosing a different window function (e.g. an exponential window, Hann window, \ldots), one could try to reduce this adverse effect.

   Another alternative for this crude rectangular windowing approach, which still uses a \gls{DFT} for the full size of the measurement record, could be to reduce the size of the \gls{DFT}.
   The introduced algorithms that determine a truncation length $\truncTime$, could also give a good indication of what size of \gls{DFT} would be suitable to represent the system well for the given measurements.
   However, further studies are required to compare the performance of these different alternatives.

   Currently, the truncation approach works based on the assumption that the last fragment of the \gls{IRF} is dominated by noise influences.
   The consequence of this is that the system is assumed to be stable and causal.
   It would be a worthwhile extension to relax this assumption to deal with unstable systems as well.
   For those systems, the last fragment of the \gls{IRF} will be dominated by the unstable (or anti-causal) part of the system. 
   Hence, the problem will become much harder to deal with, since a segment in the middle of the \gls{IRF} needs to be found where the noise level can be estimated.
   Afterwards, one could try to split up the \gls{IRF} in a part attributed to the stable poles and one caused by unstable poles and apply truncation on both parts separately and recombining the results.
\end{newquote}

\item \says{JA}{With the logarithmic spacing of the multisine, you assume a specific type of damping (all $\xi$ are the same). 
So, the FRF shapes are the same on a logarithmic scale. What if you have other shapes?}
\answer{
The assumption is not that $\xi$ is identical for all sub-systems. 
Rather, when $\xi \geq \xi_{\min}$ for all sub-systems, their relative $3\unit{dB}$ bandwidth has a minimal width and is excited well when $\alpha \leq 1 + \xi_{\min}$ (see also Figure 2.8 in the manuscript: for all $\frac{\alpha -1}{\xi_{\min}} < 1$, misalignment is no longer an issue and hence the design works well).
}
\action{A remark is added to underline this fact.}
\oldnewpage{}{?}
\begin{newquote}
In this example, the $\damping$ is set to be the same in both sub-systems. 
Using different dampings in the sub-systems would, however, not change the argument, as the sub-systems with the lowest damping will be the limiting factor.
\end{newquote}

\item \says{JA}{On page 129, in (5.17), the probability is zero. You need some interpretation of the equality sign.}
\oldnewpage{129}{?}
\action{The equality sign has been replaced by an approximate equality.}
\begin{oldquote}
The success rate $\successRate_{\bullet}$ of an initialization scheme $\bullet$ is expressed mathematically as the probability function
\begin{equation}
\successRate_{\bullet} = 
  \Prob{  \model{\bullet}=\model{\trueSymbol}  }
\text{.}
\tag{5.17}
\end{equation}
In practice, and since the iterative algorithm usually does not reach the local optimum precisely, the above definition is relaxed to the form
\begin{equation}
\successRate_{\bullet} \isdef \Prob{ \norm[2]{\model{\bullet} - \model{\trueSymbol}} < \absoluteTolerance}
\tag{5.18}
\end{equation}
with $\absoluteTolerance$ a numerical tolerance that will be specified later on.
\end{oldquote}

\begin{newquote}
The success rate $\successRate_{\bullet}$ of an initialization scheme $\bullet$ is defined as the probability that it reaches the \emph{best local optimum}, i.e.
\begin{equation}
\successRate_{\bullet} = 
  \Prob{  \model{\bullet} \approx \model{\trueSymbol}  }
\text{.}
\tag{5.17}
\end{equation}
In practice, and since the iterative algorithm usually does not reach the local optimum precisely, the above definition is implemented practically as
\begin{equation}
\successRate_{\bullet} \isdef \Prob{ \norm[2]{\model{\bullet} - \model{\trueSymbol}} < \absoluteTolerance}
\tag{5.18}
\end{equation}
with $\absoluteTolerance$ a numerical tolerance that will be specified later on.
\end{newquote}

\item \says{BP}{Guideline 2.3 seems to be dropped further in the text.}
\action{This guideline has been move to conclusion of that chapter.}
\oldnewpage{47}{?}

\item
\says{JD}{I work in electrochemistry. I use multisines to characterize Warburg impedances in $\sqrt{\omega}$ and other elements in $\sqrt[x]{\omega}$. Will LPM still work for this?}
\answer{The LPM will only provide an approximation for those applications.}
\action{A paragraph has been added to the future work section.}
\oldnewpage{}{?}
\begin{newquote}
E.g. in electrochemistry it is common~\citep{Wang1987} to describe diffusion phenomena using Warburg impedances which are proportional to $\sqrt{s}$ (with $s$ the Laplace variable).
    On the other hand, in microwave engineering~\citep{Rizzi1988,Pozar2005}, commensurate filters are easily described using Richard's variable $R=\tanh (\tau s)$ with $\tau$ the delay of the considered transmission lines.
    For these altered models, however, it should be verified whether numerical conditioning becomes a similar nuisance as for discrete-time models.
\end{newquote}

\item \action{Equation (2.6) has been rewritten and clarified}
\oldnewpage{15}{?}
\begin{newquote}
From (2.4) and (2.5) we see that scaling the optimal input power by $1-\delta$, has the following effect on the variance of the estimate:
\begin{align}
\var{\hat{G}(j\omega)}_{{(1-\delta)\mathrm{optimal} + \delta \mathrm{robust}}} \approx \frac{1}{1-\delta} \var{\hat{G}(j\omega)}_{\mathrm{optimal}}
\tag{2.6}
\text{.}
\end{align}
This is a small loss while the increase in robustness can be significant if the added signal is robust. 
\end{newquote}

\item 
\oldnewpage{xi}{?}
\old{Set of the positive real numbers without the number $0$}
\replacedBy
\new{Set of the real numbers without the number $0$}

\item
\oldnewpage{xi}{?}
\action{Added \new{\nBW: Number of excited lines in the 3 dB bandwidth of a resonance}}

\item 
\oldnewpage{4}{?}
\old{However, since most parametric estimators enforce very little prior knowledge about the system, noise in the measurements can sometimes be a problem to distinguish the actual system features.}
\replacedBy
\new{However, since most nonparametric estimators enforce very little prior knowledge about the system, it can sometimes be problematic to clearly distinguish noise in the measurements and the actual systematic behavior.}

\item 
\oldnewpage{54}{?}
\action{A remark has been added to clarify the initial values used for \gls{LRIC}.}
\begin{newquote}
The starting values for the \gls{LRIC} are obtained by means of the \gls{LRM}, the details of which are explained in Section 3.2.2.
\end{newquote}

  \item 
  \oldnewpage{56}{?}
  \says{JA}{On page 56, in (3.16): what is $\mathbf{C}$?}
  \action{There is a tilde missing. This has been changed:
  \old{$\LocalVector{C}$} \replacedBy \new{$\LocalModel{C}$}
  }
  
  \item 
  \oldnewpage{73}{?}
  \says{JA}{For (3.86), you cite Seber and Lee, 2003, but Golub was earlier. I suggest to change the reference.}
  \action{A reference to Golub has been added. Seber and Lee, however, provide a more elaborate proof such that I think their work still deserves to be mentioned.}
  \begin{newquote}
 	For linear models (i.e. $\LocalVector{Y} = \LocalMatrix{K} \LocalVector{\theta}$, such as for the {LRM} and {LPM}), however, the {PRESS} can be calculated in a single step without estimating any additional models~\citep{Golub1979}:
	\begin{equation}
	\PRESS = \frac{\LocalVector{E}^{\HT} \LocalVector{W}^{-1} \LocalVector{E}}{2N_W + 1}
         \tag{3.86}
	\end{equation}
	where $\LocalVector{E}$ is the residual vector of the full estimation and $\LocalVector{W}$ is a diagonal weighting matrix with $\LocalVector{W}_{ii} = (1 - \LocalVector{H}_{ii})^{\HT} (1 - \LocalVector{H}_{ii})$ and
	$\LocalVector{H} = \LocalMatrix{K} \pinv{\LocalMatrix{K}}$ is the so-called `hat-matrix' that is known to be idempotent.
	The proof for this can also be found in \citet[Sec.~12.3.2]{Seber2003}.
  \end{newquote}

\item 
\oldnewpage{73}{?}
\action{Constant versus varying local model complexity has been clarified.}
\begin{oldquote}
In the previous section, different methods were introduced to select the local model order. 
This begs the question whether it is advantageous to use the same local model complexity over all frequencies or the model order should be kept globally. 
The answer to this, depends on the ultimate purpose of the \gls{FRF}.
\end{oldquote}
\begin{newquote}
In the previous section, different methods were introduced to select the local model order.
This begs the question whether it is advantageous to use the same local model complexity globally over all frequencies or whether the local model order can be allowed to vary for different frequency bands.
In fact, both approaches have their merits and which of both is to be preferred, depends on the ultimate purpose of the \gls{FRF}.
\end{newquote}

  \item 
   \oldnewpage{74}{?}
   \old{Note that one should also $\nWind$ as the total number of data points (and not the number of points in each window).} 
   \replacedBy 
   \new{Note that one should interpret $\nWind$ as the total number of data points (and not the number of points in each window) for the global case.}

   \item 
   \oldnewpage{96}{?}
   \old{For an infinitely long data record, this can be described in the time-domain}
   \replacedBy
   \new{This can be described in the time-domain}

   \item 
   \oldnewpage{96}{?}
   \old{For a limited data record ($n \in \Set{0,\ldots,N-1}$)}
   \replacedBy
   \new{For a limited data record ($n \in \Set{0,\ldots,N-1}$ with $N$ the number of data points)}

  \item
  \oldnewpage{100}{?}
  \old{In the structural engineering community(\textbf{\$}))}
  \replacedBy
  \new{In the structural engineering community~\citep[see e.g.][Section 2.2.2]{Gawronski2004}}

\end{enumerate}

\section{Future Changes}
The following minor changes are not yet completed, but will be performed for the final version.

\begin{enumerate}
  \item \TODO{Improve pagination, and check for widows and orphans.}
  \item \TODO{Add the cover to the source.}
  \item \TODO{Request an ISBN and add it to the source.}
  \item \TODO{Add the DOI for the final PDF.}
  \item \TODO{Write more extensively about leakage.}
  \item \says{BP}{For the peak modeling, I suggest to take over some things of your slides in the text. For example, is there a physical interpretation of $\Delta$ (slide 20)? So it is out of scope, but how does the peak modeling help with control? That link is missing.}
  \TODO{address this}  
\item \says{TM}{In the plots, you never show the analytical bias of the LRM in the plots. Is the analytical bias a good estimate for the bias of the LRM?}
\TODO{address this}
\item \says{JA}{Below (3.17), $V$ is assumed to be i.i.d., but the noise is filtered by $A$. I suggest to change the assumption.}
\TODO{address this}
\end{enumerate}

\newpage
\printbibliography[heading=bibintoc]
\end{document}
