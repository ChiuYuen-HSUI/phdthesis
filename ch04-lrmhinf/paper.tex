\TODO{
  \begin{itemize}
    \item fix labels for chapter
    \item add section from Benchmark paper
    \item fix some bib entries
    \item Hinf macro aanpassen voor PDF support (indien dit niet conflicteert met glossaries)
  \end{itemize}
}
\input{\thisDir/styles.inc.tex}

\newcommand{\wnValue}{\ensuremath{0.95 \unit{rad/s}}}
\newcommand{\dampingValue}{\ensuremath{0.025}}
\newcommand{\TsValue}{\ensuremath{1 \unit{s}}}

\section{Introduction}
\label{sec:Intro}

Robustness is of key importance in feedback controlled systems, since feedback can lead to performance degradation or even closed-loop instability. 
An important example includes an \gls{AVIS}, where feedback is used to isolate high-precision equipment from external disturbances. 
The underlying feedback control principle is skyhook damping~\citep{Karnopp1995}. 
However, the performance of skyhook damping is limited by high-frequent parasitic resonance phenomena. 
Such model uncertainties can be taken into account explicitly in a robust control design~\citep{Zhang2005HybridAvis} for approaches based on \Hinf{} optimization.
However, the uncertainty estimation in these references is based on rough prior assumptions and may be inaccurate. 
On the one hand, this can lead to potentially dangerous results, since no stability and performance guarantees can be given if the estimated uncertainty is too small. 
On the other hand, this can also lead to overly conservative controllers if the estimated uncertainty is too large.

Several approaches have been developed to determine bounds on the model uncertainty. First, model validation techniques have been developed~\citep[see e.g.][]{Smith1992,Xu1999}.
However, these results are typically overly optimistic~\citep{Oomen2009UncEstim}.
Second, model error modeling approaches based on parametric system identification~\citep{Ljung1999MEM} with explicit characterization of bias and variance errors have been proposed, but these require a significant amount of user intervention.
Third, non-parametric identification approaches have been adopted, e.g.~\citep{vandeWal2002,deVries1994}. 
In~\citep{vandeWal2002}, an identified frequency response function is used directly to evaluate the \Hinf{} norm on a discrete frequency grid. 
In~\citep{deVries1994}, an extended method is presented that bounds the error in between frequency points in a worst-case fashion. 
However, such worst-case methods are well-known to be overly conservative~\citep[Section 9.5.2]{Vinnicombe2001}. 
Fourth, recently a data-driven \Hinf{} norm estimation has been developed in~\citep{Wahlberg2010,Oomen2014ILH}.
These methods rely on a sequence of iterative experiments and directly delivers an estimate of the \Hinf{} norm, and combines an optimal experiment design while essentially taking inter-grid errors into account.
A recent application of this method in~\citep{Oomen2014ILH} has revealed that these iterative methods lead to significantly more accurate \Hinf{} estimates compared with traditional frequency response-based methods, thereby underlining the importance of the inter-grid error.
Unfortunately, these methods require a sequence of dedicated iterative experiments.
This increases the measurement time significantly, especially for \gls{MIMO} plants.
When measurement time is expensive, this is a severe impediment.

Although important steps have been made in model-error-modeling, existing methods involve a trade-off between accuracy, measurement time, and user intervention.
The aim of the present paper is to develop a golden mean between traditional non-parametric techniques (third approach) and a full parametric model (second approach).
The proposed $\Hinf{}$ norm estimation procedure exploits recent developments in frequency domain estimation the \gls{LPM}~\citep{Schoukens2009LPM} and \gls{LRM}~\citep{McKelvey2012LRM} as introduced in~\citep{Geerardyn2014IFAC,Geerardyn2014ISMA}.
Before, these \gls{LPM} and \gls{LRM} techniques have been used to enhance at-grid frequency response estimates.
In the present paper, these methods are extended to provide both an at-grid and inter-grid evaluation of the peak value, as is required for the $\Hinf{}$ norm. 
The performance of these local parametric models with respect to robust control design is investigated, and bounds on the required measurement time to obtain a reliable estimate of the \Hinf{} norm are obtained.
Preliminary results appear in~\citep{Geerardyn2014IFAC,Geerardyn2014ISMA}.
The present paper presents the full procedure, including more theoretical treatment of the $\Hinf{}$ norm estimation procedure, and a description of the required measurement time.

\vspace{-1em}
\paragraph*{Outline}
\label{par:toc}
The problem is formulated in \secref{sec:Problem}.
In \secref{sec:LPMHinf} the novel method to estimate the $\Hinf{}$ norm by means of the \gls{LRM} is introduced.
In \secref{sec:simulation} the method is illustrated on simulations, and the required measurement time is determined.
The technique is demonstrated on measurements of an \gls{AVIS} in \secref{sec:measurement}.
Finally, the results and some challenges are discussed in \secref{sec:conclusion}.

\glsresetall % reset the usage of all abbreviations s.t. intro and body get the explanation at first use

\section{Problem Formulation}
\label{sec:Problem}
Robust control based on \Hinf{} optimization requires a nominal parametric model $\estimated\Plant$ and a bound on the model error $\Delta$. 
After the model $\estimated\Plant$ is determined, either through first principles modeling or system identification, it remains to determine a bound on the model error $\Delta$.
The \Hinf{} norm of the error system $\Delta$, i.e.
\begin{equation}
  \gamma 
     = 
       \infnorm{\Delta} 
    \isdef 
       \sup_{\omega} 
         \abs{\Delta(\omega)}
  \label{eq:HinfNormSISO}
\end{equation}
for a stable \gls{SISO} system, or its weighted form $\infnorm{W \Delta V}$, is a measure that serves an important purpose in many robust control design methodologies that specifies the `size' of the model class for which a controller is to be designed~\citep{Skogestad2005}.

To estimate $\gamma$, only $\Delta(\omega_{\star})$ is of interest, where
$ \omega_{\star} 
     \isdef 
       \arg
         \sup_{\omega} 
           \abs{\Delta(\omega)}
  \text{.}
  \label{eq:omega-star}
$
However, in a finite measurement time, non-parametric approaches only give access to a finite and discrete grid of frequencies $\omega_k \in \DFTGrid$.
As such, \eqref{eq:HinfNormSISO} can be rewritten as
\begin{equation}
  \gamma \isdef \sup_{\omega} \abs{\Delta(\omega)}
         = \sup 
             \set{
                \ezbrace{\sup_{\omega \in \DFTGrid  } \abs{\Delta(\omega)}}{\gamma_{\mathrm{FRF}}}
                \;,\;
                \ezbrace{
                \sup_{\omega \in \InterGrid} \abs{\Delta(\omega)}}{\gamma_{\mathrm{IG}}}}
  \label{eq:gamma-split-grid}
\end{equation}
where $\Omega \isdef \OpenInterval{0}{\frac{2\pi}{\Ts}}$ is the measured frequency range for a sampling time $\Ts$.
Two cases can be distinguished:
\begin{enumerate}
  \item $\omega_{\star} \in \DFTGrid$ such that $\abs{\Delta(\omega_{\star})} = \gamma =\gamma_{\mathrm{FRF}}$ is observed directly on the discrete frequency grid,
  \item $\omega_{\star} \not\in \DFTGrid$, i.e. the extremal value $\abs{\Delta(\omega_{\star})}  = \gamma = \gamma_{\mathrm{IG}}$ is determined by the inter-grid behavior.
\end{enumerate}
The use of $\gamma_{\mathrm{FRF}}$ is standard in \gls{FRF}-based approaches, e.g.~\citep{vandeWal2002}.
Its expected value over different realizations of the input signal $\expectedValue{\gamma_{\mathrm{FRF}}} \leq \gamma$ due to the limited frequency resolution.
Such an underestimate may lead to overly optimistic controller designs.

The main contribution of this paper is to  estimate the inter-grid term $\gamma_{\mathrm{IG}}$ without the need for a (global) parametric model.
Instead, a  realistic value of $\gamma$ is obtained using parametric models that are valid over small frequency ranges.

\subsection{Set-up}
\TODO{overgang $\Delta(q)$ naar output-error}

Consider an output-error \gls{LTI} discrete-time \gls{SISO} system $\Delta(q)$ excited by an input signal $u_{\Delta}(n)$.
For an infinitely long data record, this can be described in the time-domain as
\begin{equation}
  y_{\Delta}(n) 
    = 
      y_{\Delta0}
      + v(n) 
    = 
      \Delta(q)u_{\Delta}(n) 
      + H(q)e(n)
  \label{eq:sysDeltaInfData}
\end{equation}
where $q^{-1}$ is the lag operator, $e(n)$ is white Gaussian noise with unity variance, and both $\Delta(q)$ and $H(q)$ are stable causal real-rational functions.
For a limited data record ($n \in \set{0,\ldots,N-1}$), the transient contributions $t_{\Delta}(n)$ lead to:
\begin{equation}
    y_{\Delta}(n) 
      = 
        \Delta(q)u(n) 
        + H(q)e(n) 
        + t_{\Delta}(n)
    \text{.}
    \label{eq:sysDeltaFiniteData}
\end{equation}
By applying the \gls{DFT}
\begin{equation}
  X(k) 
       = 
         \frac{1}
              {\sqrt{N}} 
         \sum_{n=0}^{N-1} 
            x(n) \exp \left( \frac{- j 2 \pi k n }{N} \right)
         \quad   
         \forall k \in \mathbb{Z}
  \label{eq:DFT}
\end{equation} 
to both sides of~\eqref{eq:sysDeltaFiniteData}, one obtains:
\begin{equation}
  Y_{\Delta}(k) 
                = 
                  \Delta(\omega_k) U_{\Delta}(k) 
                  + T_{\Delta}(\omega_k) 
                  + V(k) 
  \text{.}
  \label{eq:sysDeltaFiniteDataFD}
\end{equation}
The index $k$ corresponds to the $k^{\text{th}}$ frequency bin with frequency $\omega_{k} = 2\pi k / (N \Ts)$ such that the frequency grid $\DFTGrid \isdef \set{\left.\omega_k \right| k = 1,\ldots,N-1}$.

The presented results in this paper directly extend to closed-loop systems, as is shown in \secref{sec:control}.
The results in this paper are presented in discrete time, but the extension to the continuous time case is straightforward.

\section{\Hinf{} Norm Estimation Procedure}
\label{sec:LPMHinf}
To estimate $\gamma_{\mathrm{IG}}$, we propose to identify local parametric models in the frequency domain.
The frequency axis is partitioned into continuous segments $\Omega_k \isdef \OpenInterval{ \omega_{k-1} }{ \omega_{k+1} }$ in view of the local validity of the local models.
In particular, the inter-grid aspect of the $\Hinf$ norm is estimated as
\begin{equation}
  \gamma_{\mathrm{IG}} = 
    \sup \set{ \left. 
                \sup_{\omega \in \Omega_k} \abs{\LocalModel{\Delta}_k(\omega)}
                \right|
                k = 1,\ldots,N-1
                }
   \label{eq:gamma-inter-grid}
\end{equation}
where the $\LocalModel{\Delta}_{k}$ is the local model around the ($k$th) frequency $\omega_k$.
An example of such local models is shown in \figref{fig:interpol-quantities}.
Two alternative methods allow evaluation of~\eqref{eq:gamma-inter-grid} in practice.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.8\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/interpolation-show.tikz}
  \caption{Illustration of the local models $\LocalModel{\Delta}_k$ around each frequency bin $\omega_k$ for $k\in\set{1,\ldots,6}$.
  The bottom part shows the equivalence of the frequency segments $\Omega_k$ and the intervals $\set{\omega \given{k_L(\omega) = k \vee k_R(\omega) = k}}$.}
\label{fig:interpol-quantities}
\end{figure}

\vspace{-3em}
\paragraph*{Direct method}
% \subsubsection{Direct method}
One can implement the definition~\eqref{eq:gamma-inter-grid} of $\gamma_{\mathrm{IG}}$ directly.
Hence, it boils down to solving the optimization problems
\begin{equation}
  % \gamma_{\mathrm{IG}}(k) 
  % = 
      \max_{\omega \in \Omega_k} 
      \abs{\LocalModel{\Delta}_k(\omega)}
      \label{eq:gamma-direct}
\end{equation}
for $k \in \set{1,\ldots,N-1}$.
These are tractable since $\omega$ is one-dimensional and restricted to the intervals $\Omega_k$.
Unfortunately, this approach offers no insight in the behavior of $\abs{\Delta(\omega)}$, e.g. around the peak amplitude.

\vspace{-2em}
\paragraph*{Interpolation method}
To allow inspection of $\abs{\Delta(\omega)}$ in~\eqref{eq:HinfNormSISO} for arbitrary values of $\omega \in \Omega$, we propose an interpolation approach to estimate $\gamma$ and to allow visual inspection of $\abs{\Delta(\omega)}$.
It can be understood intuitively that due to the limited validity domain of the local models, an estimate of $\Delta(\omega)$ can only be obtained from $\LocalModel{\Delta}_k(\omega)$ when $\abs{\omega_k-\omega}$ is small.
To this end, two functions that indicate respectively the left and the right adjacent local models for frequency $\omega \in \Omega$ are defined:
\begin{align}
  k_L(\omega) & 
                \isdef
                  \max
                  \set{k 
                    \given{
                      \omega_k \in \DFTGrid, 
                      \omega_k \leq \omega}
                  }\\
  k_R(\omega) & 
                \isdef
                  \min
                  \set{k 
                    \given{
                      \omega_k \in \DFTGrid, 
                      \omega_k \geq \omega}
                  }
  \text{.}
  \label{eq:kL-kR-indexing-functions}
\end{align}
Using the $k_L(\omega)$ and $k_R(\omega)$ functions, two candidate values for $\abs{\Delta(\omega)}$ are obtained: $\abs{\LocalModel{\Delta}_{k_L(\omega)}(\omega)}$ and $\abs{\LocalModel{\Delta}_{k_R(\omega)}(\omega)}$.
In view of obtaining the maximum amplitude, these are `interpolated' to obtain a single estimate:
\begin{equation}
  \abs{\Delta_{\mathrm{LRM}}(\omega)}
    \isdef
    \sup \set{
       \abs{\LocalModel{\Delta}_{k_L(\omega)}(\omega)},
        \abs{\LocalModel{\Delta}_{k_R(\omega)}(\omega)}
    }
    \label{eq:DeltaLRMInterpolation}
\end{equation}
by retaining the largest both.
It follows that
\begin{align}
  \widehat{\norm[]{\Delta_{\mathrm{LRM}}}}_{\infty} 
    & \isdef
    \sup_{\omega\in\Omega}
    \abs{\Delta_{\mathrm{LRM}}(\omega)} \\
   &  =
      \sup_{\omega\in\Omega} \; 
      \sup \set{
                 \abs{\LocalModel{\Delta}_{k_L(\omega)}(\omega)}, 
                 \abs{\LocalModel{\Delta}_{k_R(\omega)}(\omega)}}
  \label{eq:gammaInterpolOptim}
  \text{.}
\end{align}

\vspace{-2em}
\paragraph*{Remarks:}
The optimization problems~\eqref{eq:gammaInterpolOptim} and~\eqref{eq:gamma-direct} can, e.g. be solved by griding the frequency $\omega$.
The peak amplitudes obtained using~\eqref{eq:gammaInterpolOptim} and~\eqref{eq:gamma-direct} are identical since the local models $\LocalModel{\Delta}_k$ are evaluated over identical frequency ranges
$% \begin{equation}
  \Omega_k = \set{\omega \given{k_L(\omega) = k \vee k_R(\omega) = k}}
$ % \end{equation}
for both methods (but in different order) and aggregated using the supremum operator, which is indifferent to the order of its arguments.
In \figref{fig:interpol-quantities} the functions $k_L(\omega)$ and $k_R(\omega)$ are visualized and the equivalence with $\Omega_k$ is apparent.

\subsection{The \glsentrydesc{LRM}}
\label{sec:LRM}
The local models $\LocalModel{\Delta}_k$ are estimated using the \gls{LRM}~\citep{McKelvey2012LRM}.
The \gls{LRM} exploits the fact that the transfer function $\Delta(\omega)$ and the leakage term $T_{\Delta}(\omega)$  in \eqref{eq:sysDeltaFiniteDataFD} are smooth functions of the frequency.
As such, $\Delta$ and $T_{\Delta}$ are approximated locally by rational functions around each bin $k$:
\begin{align}
  \Delta(\omega_{k+r})     
    &\approx 
        \frac{\sum_{i=0}^{N_{B}} b_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}} 
      = 
        \frac{B_k(r)}{A_k(r)} 
      \isdef 
        \LocalModel{\Delta}_{k}(\omega_{k+r})
      \label{eq:LRMTaylorSystem} \\
  T_{\Delta}(\omega_{k+r}) 
    &\approx 
        \frac{\sum_{i=0}^{N_{T}} t_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}}  
      = 
        \frac{T_k'(r)}{A_k(r)} 
      \isdef 
        \LocalModel{T}_{k}(\omega_{k+r})
  \label{eq:LRMTaylorTransient}
  \text{.}
\end{align}
Its local parameters $a_{i}(k)$, $b_{i}(k)$ and $t_{i}(k)$ are estimated by considering~\eqref{eq:sysDeltaFiniteDataFD} in the local window $\LocalWindow = \set{-N_W,\ldots,+N_W}$ around each bin $k$.
This yields
\begin{equation}
  Y_{\Delta}(k+r) 
                 \approx
                    \Delta(\omega_{k+r}) U_{\Delta}(k+r) 
                    + T_{\Delta}(\omega_{k+r}) 
    \quad
    \forall r \in \LocalWindow
    \text{.}
    \label{eq:LocalWindowSpectra}
\end{equation}
By substituting the local models $\LocalModel{\Delta}_k$ and $\LocalModel{T}_k$, one obtains
\begin{align}
  Y_{\Delta}(k+r) 
                  & \approx
                    \LocalModel{\Delta}_k(\omega_{k+r}) U_{\Delta}(k+r) 
                    + \LocalModel{T}_k(\omega_{k+r}) 
                    & \forall r \in \LocalWindow \\
                  & = 
                    \frac{B_k(r)}{A_k(r)} U_{\Delta}(k+r) 
                    + 
                    \frac{T'_k(r)}{A_k(r)} 
                    & \forall r \in \LocalWindow
    \text{.}
    \label{eq:LocalWindowSpectraLRM}
\end{align}
To make this expression linear in the parameters $a_i(k)$, both sides are multiplied by $A_k(r)$ as in~\citep{Levy1959}.
By doing so, the local linear-least-squares cost function
\begin{equation}
  \sum_{r=-N_W}^{N_W} 
  \left| 
    A_k(r) Y_{\Delta}(k+r) - B_k(r) U_{\Delta}(k+r) - T'_{k}(r)
  \right|^2
  \label{eq:localCostLRM}
\end{equation}
 around each bin $k$ can be constructed.
We denote $\lrm{N_W,N_B,N_A,N_T}$ to be the \gls{LRM} with the orders $N_B$, $N_A$, $N_T$ and bandwidth $N_W$ defined above.
For $N_A=0$ the \gls{LRM} simplifies to the \gls{LPM} which we shall denote as $\lpm{N_W,N_B,N_T}$.

For a more detailed overview of  the \gls{LPM} and \gls{LRM} see~\citep{Schoukens2009LPM,Pintelon2010LPM1,Pintelon2010LPM2,McKelvey2012LRM}.


\section{Simulation}
\label{sec:simulation}
To allow the generalization of the results of the simulations, we first introduce a way to decompose complex systems into simpler systems.
The behavior of these simpler systems then allows to predict the behavior for these more complex systems.
Any real-rational system $\Delta$ can be decomposed in a parallel structure of lower-order sub-systems by means of a partial fraction expansion as in \eqref{eq:excitation:PFE} and using the same logic as in \chapref{sec:excitation}.
As a result, systems can often be well-represented, in a small frequency range, by a sum of a few low-order sub-systems (often first or second order for e.g. mechanical systems)~\citep[Section 2.2.2]{Gawronski2004}.
To estimate $\norm{\Delta}$ mainly the resonant sub-systems are of interest.
Assuming such resonances are sufficiently separated in the frequency,~\citep{Schoukens2013LPMerror,Geerardyn2013TIM,Gawronski2004} show that results for a single resonance are applicable to more complex systems.
This is done by considering only the dominant resonance -- \emph{viz.} the one that is the most relevant for the $\Hinf{}$ controller design.
By normalizing the conclusions for the time constant $\timeconst$ (or the $3\unit{dB}$ bandwidth), the results are generally valid for different values of the damping $\damping$.
Specifically, the system's $\timeconst \isdef (\damping \wn)^{-1}$ dictates the required measurement time~\citep{Schoukens2013LPMerror}, where $\damping$ is the relative damping and $\wn$ the undamped natural frequency.

\subsection{A concrete simulation}
Consider a discrete time system $\Delta$ (see \figref{fig:exampleIntergrid}) as unmodeled dynamics in an output-error setting:
\begin{equation}
  \Delta(z) 
    =  \frac{0.45373 z + 0.44752}
            {z^2 - 1.0595 z + 0.96079}
  \label{eq:O2sysDT}
  \text{,}
\end{equation}
which has $\timeconst = 50 \unit{samples}$ (i.e. $\damping=0.02$ and $\wn = 1 \unit{rad/s}$).
The input signal $u_{\Delta}$ is white Gaussian noise with unit variance and the disturbing noise variance $\sigma_v^2$ is chosen such that a \gls{SNR} 
\begin{equation}
  \SNR = \frac{\sqrt{\inv{N}\sum_n y_{\Delta0}^2(n) }}%
              {\sqrt{\inv{N}\sum_n v^2(n) }}
       = \frac{\sigma_{y_{\Delta0}}}{\sigma_v}
       \approx \frac{\norm[2]{\Delta} \sigma_{u_{\Delta}}}{\sigma_v}
  \label{eq:SNR}
\end{equation}
of $10$ is obtained.

Classical \gls{SA} techniques~\citep{Bendat1980} can estimate the \gls{FRF} of $\Delta$.
This is done by first splitting the input/output signals into $N_S$ segments of ${N}/{N_S}$ samples, windowing the segments to reduce leakage and applying the \gls{DFT}.
By dividing the resulting output/input spectra, the \gls{FRF} is obtained.
In this paper a Hann window and $N_S=1$ are used.
Note that $N_S>1$  increases the measurement time by a factor $N_S$ to attain the same frequency resolution (but would improve  transient and noise rejection).

\figref{fig:exampleIntergrid} illustrates for $N=97$ that $\gamma_{\mathrm{FRF}}$ for the \gls{SA}, $\lpm{5,4,4}$ and $\lrm{5,2,2,2}$ approaches yield unreliable estimates of $\infnorm{\Delta}$, since the frequency resolution is too coarse.
The specific orders of  \gls{LRM}/\gls{LPM} have been chosen to  keep $N_W$ small while not restricting ourselves to linear models ($N_B=1$). 
Slightly different orders (e.g. $\lrm{4,1,1,1}$) yield comparable results.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.75\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/example-both.tikz}
  %\input{\thisDir/figs/example-LRM-SNR1.tikz}
  \caption{Simulation example revealing that $\gamma_{\mathrm{FRF}}$ (left) for both the \glsfirst{SA}~\legref{leg:example-SA} and \gls{LRM}~\legref{leg:example-LRM} underestimate the true $\gamma = \norm{\Delta} = 24$~\legref{leg:example-true-Hinf} due to limited frequency resolution.
  Using the proposed \gls{LRM}-based approach, both the at-grid~($\gamma_{\mathrm{FRF}}$) and intergrid~($\gamma_{\mathrm{IG}}$) estimate are improved.
  The interpolated \gls{LRM}~\legref{leg:example-LRM-interpol} and true $\Delta$~\legref{leg:example-true} almost coincide.
  Hence, $\widehat{\norm[]{\Delta_{\mathrm{LRM}}}}_{\infty}$~\legref{leg:example-LRM-interpol-Hinf} approaches the theoretical $\gamma=24$.}
  \label{fig:exampleIntergrid}
\end{figure}

It can be observed for $\gamma_{\mathrm{IG}}$ in \figref{fig:exampleIntergrid} that the \gls{LRM} is able to model the resonance well and yields a useful estimate $\infnorm{\Delta_{\mathrm{LRM}}} = 24$ in the simulation.
Intuitively, the \gls{LRM} locally approximates the resonant pole which allows for a reliable inter-grid estimate.
The \gls{LPM}, on the other hand, does not provide a reliable estimate.

\subsection{Study of the experiment length}
Frequency resolution, and hence the experiment length, is key to obtain a reliable \Hinf{} norm estimate.
In this section, we determine the minimal experiment length needed for the proposed approach by means of simulations.

We simulate the system \eqref{eq:O2sysDT} for $16\,100$ samples and discard the first $100$ samples to randomize the initial conditions.
To mimic the effect of progressively measuring longer data records, the first remaining $N$ samples are used to estimate $\infnorm{\Delta}$ as in \secref{sec:LPMHinf}.
The values of $N \in \ClosedInterval{35,16\,000}$ are chosen such that $\expectedValue{\gamma_{\mathrm{FRF}}(N)}$ is a non-decreasing function of $N$.
These simulations are then repeated in a Monte Carlo simulation of $n_{\mathrm{MC}}=200$ runs where each run has a different realization of  $u_{\Delta}(n)$ and $v(n)$.
The resulting sample average and standard deviation $\sigma$ are shown in \figref{fig:MC-run-length}.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.75\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/MC-runlength.tikz}
  %\input{figures/runLength.tikz}
  \caption{The $\Hinf{}$ norm~\legref{leg:runlength-true} is underestimated significantly for short experiments ($N<20\timeconst$) by $\expectedValue{\gamma_{\mathrm{FRF}}}$~\legref{leg:runlength-frf} and the \gls{LPM}~\legref{leg:runlength-LPM}.
  However, the proposed $\widehat{\norm[]{\Delta_{\mathrm{LRM}}}}_{\infty}$~\legref{leg:runlength-LRM} is already reliable from much shorter experiments ($N \geq 4 \timeconst$). A single observation for $N=97$~\legref{leg:runlength-special-case} is shown in \figref{fig:exampleIntergrid}. The shaded areas show the $\pm \sigma$ intervals which are mostly due to the noise.
  }
\label{fig:MC-run-length}
\end{figure}

It can be seen in \figref{fig:MC-run-length} that $N \geq 20\timeconst$ is required to attain a frequency grid that is dense enough to obtain a reliable $\gamma_{\mathrm{FRF}}$, i.e. $\expectedValue{\gamma_{\mathrm{FRF}}} \approx \gamma$.
Starting from about $N=4 \text{ to } 5\timeconst$, the interpolated \gls{LRM} starts to yield good estimates for $\gamma_{\mathrm{IG}}$.
For long experiments $(N \to \infty)$, the true $\norm{\Delta}$ is recovered.
Practically, this implies that the interpolated \gls{LRM} beats the on-grid estimate using a data record that is only a fraction of the length.

\section{Application to an \glsentryname{AVIS}}
\label{sec:measurement}
The proposed method is illustrated on the \gls{AVIS} shown in \figref{fig:avis}.
The \gls{AVIS} consists of a support fixed to the ground and a payload platform, suspended on airmounts, that is free to move in six degrees of freedom.
Six geophones measure the payload velocity and eight linear motors allow to actively compensate for vibration of the platform.
To facilitate the presentation, only the vertical translation, i.e. a \gls{SISO} system,  is considered.

\subsection{Measurement \& control framework}
\label{sec:control}
The experiments on the \gls{AVIS} are carried out in closed-loop (\figref{fig:tpc}) with $r_2 = 0$.
The controller $\Controller=\experimental\Controller$  stabilizes the \gls{AVIS} but yields only moderate vibration isolation.
The $r_1$ input consists of five periods of a random phase multisine~\citep{Geerardyn2013TIM} of $65\,536$ samples with excited bins such that $\omega_k \approx 1.001 \omega_{k-1}$  and $\Ts=1\unit{ms}$.

\begin{figure}
 \centering
 \input{\thisDir/figs/tpcrobust.tikz}
 \caption{The considered feedback configuration $\ClosedLoop{\ModelSet[],\Controller}$.}
 \label{fig:tpc}
\end{figure}

\begin{figure}
 \centering
 \input{\thisDir/figs/dualYoula.tikz}
 \caption{Dual-Youla parametrization of the closed-loop set-up  with controller $\Controller$,  model set $\ModelSet[]$ and nominal plant model $\estimated\Plant$.}
\label{fig:dualYoula}
\end{figure}

The parametrization of the plant model set $\ModelSet[]$ conforms to the dual-\YK{} framework~\citep{Hansen1989,Anderson1998} that parametrizes $\ModelSet[]$ in terms of  all plants $P$ that are stabilized by the controller $C$:
\begin{equation}
  \ModelSet[] 
    \isdef 
      \set{
          \left. 
            \frac{\hat{N} + D_c \Delta}
                 {\hat{D} - N_c \Delta} 
          \right| 
            \hinfnorm{\Delta} \leq \gamma
        }
  \label{eq:dualYoulaModelSet}
  \text{,}
\end{equation}
where $C=N_c D_c^{-1}$ and $\estimated\Plant = \estimated{N}\estimated{D}^{-1}$ are decomposed as \gls{RCF} (see \figref{fig:dualYoula}).
To estimate $\Delta$ and $\hinfnorm{\Delta}$, the signals $u_{\Delta}$ and $y_{\Delta}$ in~\figref{fig:dualYoula} are required.
These can be computed from $u$ and $y$ directly~\citep{Anderson1998}.
In addition, $u_{\Delta}$ is noise free under standard assumptions~\citep{Hansen1989}, hence the method of \secref{sec:LPMHinf} applies.

The non-uniqueness of the \gls{RCF} can be exploited to satisfy additional conditions.
In view of the robust control criterion
\begin{equation}
  \Crit(\Plant,\Controller) 
    \isdef 
      \infnorm{W \ClosedLoop{\Plant,\Controller} V}
  \label{eq:controlCrit}
  \text{,}
\end{equation}
the \glspl{RCF} are constructed such that
$
  \worstCase\Crit \left( \ModelSet[], \experimental\Controller \right)
  \leq
  \Crit \left( \estimated\Plant, \experimental\Controller \right)
  + \gamma
$
where $\worstCase\Crit(\ModelSet[],C) \isdef \sup_{P\in\ModelSet[]} \Crit(P,C)$~\citep{Oomen2012SIRP}.
% Obviously, $\Crit( \true\Plant, \experimental\Controller) \leq \worstCase\Crit ( \ModelSet[], \experimental\Controller )$ is guaranteed when $\true\Plant \in \ModelSet[]$.
I.e. even for a weighted control criterion \eqref{eq:controlCrit}, there is no need to incorporate weights $W'$ and $V'$ into the estimation of the uncertainty bound as $\infnorm{W' \Delta V'}$.
In this paper, an eighth-order $\estimated\Plant$~(\figref{fig:avis-frf}) is estimated.
Some dynamics are left unmodeled and are hence part of $\Delta$~(\figref{fig:avisMeas}).

\begin{figure}
  \centering
  \setlength\figurewidth{0.75\columnwidth}
  \includegraphics[width=\figurewidth]{\thisDir/figs/avis.jpg}
  \caption{\Glsentryfirst{AVIS}.}
  \label{fig:avis}
\end{figure}

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.75\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
    \input{\thisDir/figs/avis-frf.tikz}
 \caption{Measured \gls{FRF} \legref{m2t:plantFRF} and estimated parametric model $\hat{P}$ \legref{m2t:plantModel} of the \glsfirst{AVIS}.}
 \label{fig:avis-frf}
\end{figure}

\subsection{Results}
\label{sec:resultsAvis}
To estimate $\Delta(\omega_k)$ and $\hinfnorm{\Delta}$  using the proposed approach with $\lrm{6,2,2,2}$, an estimation dataset consisting of only a fourth of the excited bins is used.
The full dataset that includes bins not used in the estimation is used to validate the interpolation results.

The measured $\Delta$ is shown in \figref{fig:avisMeas} for the whole frequency band and \figref{fig:avisMeasZoom} for a frequency range containing $\omega_{\star}$.
Two aspects of the proposed method are examined.
First, the interpolation results for a continuous frequency range are validated.
Second, the peak amplitudes of $\Delta(\omega)$ are inspected as these are  indicators for $\infnorm{\Delta}$.

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.75\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
    % \input{\thisDir/figs/avis-delta-full.tikz}
    \TODOfig{split plots}
 \caption{Measured (dual-Youla) $\Delta$ for the \gls{AVIS} using the \gls{LRM} and the proposed interpolation. The data in the rectangle is also shown in \figref{fig:avisMeasZoom}.}
\label{fig:avisMeas}
\end{figure}

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.75\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
   \input{\thisDir/figs/avis4.tikz}
 \caption{Measured $\Delta$ for the \gls{AVIS} using the \gls{LRM}~\legref{leg:avis4-LRMi} and the proposed interpolation. Clearly, the \gls{LRM} leads to a higher peak value~\legref{leg:avis4-LRM-hinf}, especially at $328\unit{Hz}$. The validity of the LRM local parametric model is confirmed by the validation measurement at the dense frequency grid~\legref{leg:avis4-validation}, which reveals excellent interpolation properties and a similar peak value~\legref{leg:avis4-valid-hinf}.}
\label{fig:avisMeasZoom}
\end{figure}

\vspace{-2em}
\paragraph*{Interpolation performance}
\label{sec:avis-interpol}
\figref{fig:avisMeas} and \figref{fig:avisMeasZoom} show that the estimation and validation data for \gls{LRM} are generally in agreement.
In the frequency range shown in \figref{fig:avisMeasZoom}, the relative difference between both is at most $2\%$.

\vspace{-2em}
\paragraph*{Peak value estimates}
\label{sec:avis-peak-value}
Near $296\unit{Hz}$, a modest improvement of the peak estimate from $-15.3 \unit{dB}$ (at-grid) to $-14.0 \unit{dB}$ is obtained by the interpolation.
The estimate near $\omega_{\star} \approx 328\unit{Hz}$ is improved more substantially.
The proposed method \eqref{eq:gammaInterpolOptim} yields $\gamma_{\mathrm{IG}}=-2.5\unit{dB}$.
$\gamma_{\mathrm{FRF}}\approx -9.9\unit{dB}$ for the estimation data, which means that a $7.4\unit{dB}$ improvement is achieved by the proposed method.
This peak agrees well with the validation data, where the nearest (at-grid) value has an amplitude of $-3.2\unit{dB}$ (i.e. $8\%$ difference).

This suggests that the local rational models with interpolation are a very good approximation to the actual $\Delta$ and also to estimate $\hinfnorm{\Delta}$ even if the actual peak does not coincide with the discrete frequency grid.

\section{Conclusion and Further Research}
\label{sec:conclusion}
A reliable \Hinf{} norm estimation technique for high performance, non-conservative robust control design is investigated.
In this paper, a new approach is presented that employs so-called local parametric \gls{LRM} models that lead to an enhanced estimate of $\norm{\Delta}$ of a \gls{SISO} error system by interpolating between neighboring local models.
It is also shown that the \gls{LPM} is not a worthwhile alternative to the \gls{LRM} to estimate $\norm{\Delta}$.
The technique is illustrated on a simulation example where the \gls{LRM}-based interpolation yields a reliable estimate of the $\Hinf{}$ norm.
It is observed that the measurement time is reduced by almost an order of magnitude compared to techniques that only examine $\Delta(\omega)$ on the \gls{DFT} frequency grid.
Using measurements on an \gls{AVIS}, it is illustrated that the interpolation-based results can substantially improve $\hinfnorm{\Delta}$ and/or reduce the measurement time four-fold.
Furthermore, the results are validated by a detailed validation measurement.
Ongoing research focuses on extending the technique to \gls{MIMO} systems and the study of its stochastic properties.
