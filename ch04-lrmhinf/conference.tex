% arara: pdflatex: { shell : yes }
% arara: bibtex
% arara: makeglossaries
% arara: pdflatex: { shell : yes, synctex : yes}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{xspace}
smart
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{tangocolors}
\usepackage{tikz}
\usetikzlibrary{spy}
\usepackage{pgfplots}

\usepackage{color}
\newcommand{\EDIT}{\textcolor{red}{EDIT}}

\newlength\figureheight 
\newlength\figurewidth 

%\usepackage{hyperref}

\input{definitions.inc.tex}
\input{blockdiag.inc.tex}
\input{styles.inc.tex}

\usepackage{graphicx}
\graphicspath{{./figures/}{.}{./tikz/}}

\newcommand{\TODO}[1]{ {\color{red} #1} }


\newcommand{\wnValue}{\ensuremath{0.95 \unit{rad/s}}}
\newcommand{\dampingValue}{\ensuremath{0.025}}
\newcommand{\TsValue}{\ensuremath{1 \unit{s}}}

\begin{document}

\begin{frontmatter}

\title{Enhancing \Hinf{} Norm Estimation using Local LPM/LRM  Modeling: Applied to an AVIS\thanksref{thx}}

\thanks[thx]{This work is supported by the Fund for Scientific Research (FWO-Vlaanderen), by the Flemish Government (Methusalem), and by the Belgian Government through the Interuniversity Poles of Attraction (IAP VII-Dysco) Program, the Innovational Research Incentives Scheme under the VENI grant ``Precision Motion: Beyond the Nanometer'' (no. 13073) awarded by NWO (Netherlands Organization for Scientific Research) and STW (Dutch Science Foundation).}

\author[VUB]{Egon Geerardyn} 
\author[TUE]{Tom Oomen} 
\author[VUB]{Johan Schoukens}

\address[VUB]{ELEC Department, Vrije Universiteit Brussel, Brussels, Belgium. \\ (e-mails: \href{mailto:egon.geerardyn@vub.ac.be}{egon.geerardyn}, \href{mailto:johan.schoukens@vub.ac.be}{johan.schoukens} @vub.ac.be)}
\address[TUE]{Control System Technology Group, Mechanical Engineering Department, Technische Universiteit Eindhoven, Eindhoven, the Netherlands. (e-mail: \href{mailto:t.a.e.oomen@tue.nl}{t.a.e.oomen@tue.nl})}

\begin{keyword}
Frequency-response;
Uncertainty;
Norms;
Estimation;
Polynomials;
Signal Processing;
System Identification;
Robust Control.
\end{keyword}

\begin{abstract}~
Accurate uncertainty modeling is of key importance in high performance robust control design. 
The aim of this paper is to develop a new uncertainty modeling procedure that leads to enhanced accuracy for the $\mathcal{H}_\infty$ norm. 
A frequency response based approach is adopted. 
The key novelty of this paper is a new method to address the intergrid error using local parametric modeling methods. 
These local polynomial and rational models enhance the estimates at the discrete frequency grid.
Moreover, the presented methods are shown to enhance the intergrid error estimate.
This is illustrated using simulations and experiments on an industrial active vibration isolation system.
Compared to the local polynomial models, local rational models are able to handle lightly-damped resonances using far fewer data points, which means that measurement time can be kept short.
\end{abstract}

\end{frontmatter}

\section{Introduction}
\label{sec:Intro}

Robustness is of critical importance in feedback controlled systems, since feedback control can lead to performance degradation or even closed-loop instability. 
An important example includes an \gls{AVIS}, where feedback is used to isolate high-precision equipment from external disturbances. 
The underlying feedback control principle is skyhook damping \citep{Karnopp1995}. However, the performance of skyhook damping is limited by high-frequent parasitic resonance phenomena. 
Such model uncertainties can be taken account explicitly in a robust control design, see, e.g., \citet{Zhang2005HybridAvis} and \citet{Chida2008} for approaches based on \Hinf{} optimization. 
However, the uncertainty estimation in these references is based on rough prior assumptions and hence inaccurate. 
On the one hand, this can lead to potentially dangerous results, since no stability and performance guarantees can be given if the estimated uncertainty is too small. 
On the other hand, this can also lead to potentially conservative results, since if the estimated uncertainty is too large, the resulting controller is robust for an overly large class of candidate systems.

Several approaches have been developed in the literature to determine accurate bounds on the model uncertainty. First, model validation techniques have been developed, see \cite{Poolla1994} for time domain results and \cite{Smith1992} for frequency domain results. 
However, these results are typically overly optimistic, as is shown in \cite{Oomen2009UncEstim}. 
Second, model-error-modeling approaches based on parametric system identification with explicit characterization of bias and variance errors has been proposed in \cite{Ljung1999MEM}. 
An important aspect in these methods is that these require a significant user intervention in the model parameterization step and rely on assumptions that are asymptotic in the data length. 
Third, non-parametric identification approaches have been adopted, e.g., as in \Citet{vandeWal2002}, \Citet{deVries1994}. 
In \Citet{vandeWal2002}, an identified frequency response function is used directly to evaluate the \Hinf{} norm on a discrete frequency grid. In \Citet{deVries1994}, an extended method is presented that bounds the error in between frequency points in a worst-case approach. 
However, such worst-case methods are well-known to be overly conservative \cite[Section 9.5.2]{Vinnicombe2001}. Fourth, recently a data-driven \Hinf{} norm estimation has been developed in \cite{Wahlberg2010} and \cite{Oomen2014ILH}. 
This method relies on a sequence of iterative experiments and directly delivers an estimate of the \Hinf{} norm, and combines an optimal experiment design while essentially taking intergrid errors into account.
Recent application of this method in \cite{Oomen2014ILH} has revealed that these iterative methods lead to much higher \Hinf{} estimates compared with traditional frequency response-based methods, thereby underlining the importance of the intergrid error.

Although recently developed data-driven algorithms provide an accurate estimation of the \Hinf{} norm, these methods require a sequence of dedicated iterative experiments. 
In addition, the required number of experiments inflates in the multivariable case, see \cite{Oomen2014ILH}. 
The aim in this paper is to develop a method that provides accurate estimates of the \Hinf{} norm using data from a single experiment. 

The main contribution of this paper is a new method for \Hinf{} norm estimation by exploiting recently developed \gls{LPM}~\citep{Schoukens2009LPM} and \gls{LRM}~\citep{McKelvey2012LRM} identification approaches.
These frequency-local models constitute a golden mean between simple non-parametric techniques (third approach) and a full parametric model (second approach). 
In particular, these methods lead to an improved frequency response estimation at the standard \gls{DFT} grid and provide an accurate estimation of the intergrid behavior. 

\subsubsection{Contents}
\label{par:toc}
In \secref{sec:Problem}, the problem is formulated and illustrated on an example.
In \secref{sec:LocalModels}, the local modeling methods -- \gls{LPM} and \gls{LRM} are introduced, including the relevant notation.
The main contribution of this paper, which is a new approach for estimating \norm{\Delta} employing these local methods, is presented in \secref{sec:LPMHinf}. The example in \secref{sec:example} is revisited in \secref{sec:simulation}.
Afterwards, the technique is illustrated on measurement data of an \gls{AVIS} in \secref{sec:measurement}.
Finally, the obtained results and some challenges are discussed in \secref{sec:conclusion}.

\glsresetall % reset the usage of all abbreviations s.t. intro and body get the explanation at first use

\section{Problem Formulation}
\label{sec:Problem}
Robust control based on \Hinf{} optimization requires a nominal parametric model $\hat P$ and a bound on the model error $\Delta$. 
After the model $\hat P$ is determined, either through first principles modeling or system identification, it remains to determine a bound on the model error $\Delta$. 
The \Hinf{} norm of the model error $\Delta$, i.e.
\begin{equation}
  \gamma = \infnorm{\Delta} \isdef \sup_{\omega} \abs{\Delta(\omega)}
  \label{eq:HinfNormSISO}
\end{equation}
for a \gls{SISO} system, or its weighted form $\infnorm{W \Delta V}$, is a measure that serves an important purpose in many robust control design methodologies that specifies the `size' of the model class for which a controller is to be designed \citep{Skogestad2005,Oomen2012SIRP}.
In this paper, the non-weighted \Hinf{} norm is considered to facilitate the presentation. 
The proposed approach can be adapted straightforwardly to incorporate the weighting filters $W$ and $V$.

In this paper, a frequency response-based approach is pursued. 
When only a limited amount of data is measured, the frequency resolution of the \gls{FRF} is limited and this can cause unreliable estimates of $\hinfnorm{\Delta}$ when resonances are present. 
The goal of this paper is to obtain an accurate estimate of $\hinfnorm{\Delta}$ using a finite amount of input-output data of a single (generic) experiment carried out on the set-up explained below.

\subsection{Set-up}
Consider the \gls{LTI} discrete-time \gls{SISO} system $\Delta(q)$ that is shown in \figref{fig:DeltaOpenLoop}. 
The system is excited by input signal $u_{\Delta}(n)$ and the output $y_{\Delta}(n) = y_{\Delta0}(n) + v(n)$ where $v(n)$ is colored additive noise (i.e. $v(n) = H(q)e(n)$).
We measure $N$ samples of the input $u_{\Delta}$ and output $y_{\Delta}$ and try to determine both the \gls{FRF} of $\Delta$ and $\infnorm{\Delta}$ from this data.

It is emphasized that the presented results in this paper directly extend to closed-loop systems, as is explained in detail in \secref{sec:control}. 
\begin{figure}
  \centering
  \input{figures/deltaopenloop.tikz}
  \caption{Model-error system $\Delta$ in open loop.}
  \label{fig:DeltaOpenLoop}
\end{figure}

\subsection{Motivating Example}
\label{sec:example}
Consider the discrete time (model-error) system $\Delta$ (as in \figref{fig:DeltaOpenLoop}) as unmodeled dynamics:
\begin{equation}
  \Delta(z) = \frac{0.412 z + 0.405}{z^2 - 1.137 z + 0.954}
  \label{eq:O2sysDT}
  \text{,}
\end{equation}
with  sampling time $\Ts=\TsValue$, which is the zero-order-hold transformed second-order continuous time system.
The input $u_{\Delta}$ is white Guassian noise with unit variance and the disturbing noise variance $\sigma_v^2$ is chosen such that a \gls{SNR} 
\begin{equation}
  \SNR = \frac{\sqrt{\inv{N}\sum_n y_{\Delta0}^2(n) }}%
              {\sqrt{\inv{N}\sum_n v^2(n) }}
       = \frac{\sigma_{y_{\Delta0}}}{\sigma_v}
       \approx \frac{\norm[2]{\Delta} \sigma_u}{\sigma_v}
  \label{eq:SNR}
\end{equation}
of $0\unit{dB}$ at the output is obtained.

Using classical \gls{SA} techniques -- i.e. splitting the signals into $N_S$ segments, applying a window before using the \gls{DFT} and averaging the \glspl{FRF} over the segments -- an \gls{FRF} of $\Delta$ can be obtained.
In \figref{fig:exampleFRF}, the ensuing \gls{FRF} for a Hann window and $N_S=1$ (no averaging) is shown together with those obtained using the local modeling methods introduced in this paper.
% persoon: Von Hann. Het venster wordt vaak gewoon Hann genoemd (of zelfs Hanning, maar die vind ik te verwarrend t.o.v. Hamming (naam & venster))

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.9\columnwidth}
  \setlength{\figureheight}{0.8\figurewidth}
  \input{figures/example-LRM-SNR1.tikz}
  \caption{Simulation example revealing that \glsfirst{SA} leads to an underestimate $\infnorm{\Delta}$. The proposed approach using \gls{LRM} significantly enhances the intergrid estimate as well as the at-grid estimate. For comparison, it is shown that \gls{LPM} does not perform well in this situation. The interpolated \gls{LRM} and true $\Delta$ almost coincide.}
  \label{fig:exampleFRF}
\end{figure}

From \figref{fig:exampleFRF} it shows that the \gls{SA} approach is not advisable to estimate $\infnorm{\Delta}$, since the frequency resolution is not dense enough to properly capture the actual resonance peak.
Increasing $N_S$ will reduce the variability of this estimate, at the cost of a decreased frequency resolution, so it is even more likely to `overlook' a resonance that is detectable from the data.

\subsection{Proposed approach}
The proposed in this paper is to use local parametric modeling methods, including \gls{LPM} and \gls{LRM} to
\begin{itemize}
\item enhance the \gls{FRF} estimate of $\Delta$ at the \gls{DFT} grid; and
\item exploit the local parametric models for accurate intergrid error estimation.
\end{itemize}
A key aspect herein is that the proposed approach does not require a global parametric model of the error system.

\section{Local Modeling Methods}
\label{sec:LocalModels}
In the following section the \gls{LPM} and \gls{LRM} are introduced and some practical consideration are given.
We first start from the global system equations and introduce the approximations made by the local modeling methods.

The system in \figref{fig:DeltaOpenLoop} can be described, for an infinitely long data record, by
\begin{equation}
  y_{\Delta}(n) = \Delta(q)u(n) + v(n) = \Delta(q)u(n) + H(q)e(n)
  \label{eq:sysDeltaInfData}
\end{equation}
where $n = \frac{t}{\Ts}$ is the time instant normalized by the sampling time $\Ts$, $q^{-1}$ is the lag operator and both $\Delta(q)$ and $H(q)$ are stable causal real-rational functions.
For the practical situation where the data length is limited ($n \in \set{0,\ldots,N-1}$), \eqref{eq:sysDeltaInfData} has to include the influence of the system transient $t_{\Delta'}(n)$ and the noise transient $t_{H}(n)$:
\begin{equation}
    y_{\Delta}(n) = \Delta(q)u(n) + H(q)e(n) + \overbrace{t_{\Delta'}(n) + t_{H}(n)}^{t_{\Delta}(n)}
    \label{eq:sysDeltaFiniteData}
\end{equation}
where both transient contributions can be combined into a single transient term $t_{\Delta}(n)$.

By applying the \gls{DFT}
\begin{equation}
  X(k) = \frac{1}{\sqrt{N}} \sum_{n=0}^{N-1} x(n) \exp \left( \frac{- j 2 \pi k n }{N} \right)
  \label{eq:DFT}
\end{equation} 
to both sides of \eqref{eq:sysDeltaFiniteData}, its frequency domain equivalent is obtained:
\begin{equation}
  Y_{\Delta}(k) = \Delta(\omega_k) U_{\Delta}(k) + T_{\Delta}(\omega_k) + V(k)
  \label{eq:sysDeltaFiniteDataFD}
\end{equation}
The index $k$ corresponds to the $k^{\text{th}}$ frequency bin with frequency $\omega_{k} = 2\pi k / (N \Ts)$.

\subsection{The \glsentrydesc{LPM}}
\label{sec:LPM}
The \gls{LPM} revolves around the observation that the transfer function $\Delta(\omega)$ and the leakage term $T_{\Delta}(\omega)$ are smooth over the frequency, and as such can be approximated well by a Taylor series \citep{Schoukens2009LPM}.

In the \gls{LPM} these Taylor series are estimated by considering a local window ($r = -N_{W}, \ldots, N_{W}$) of $2N_{W} + 1$ lines around each frequency bin $k$:
\begin{align}
  \Delta(\omega_{k+r})     &\approx \delta_{0}(k) + \sum_{i=1}^{N_{B}} \delta_{i}(k) r^{i} &\isdef \ctr\Delta_{k}(r)\label{eq:LPMTaylorSystem} \\
  T_{\Delta}(\omega_{k+r}) &\approx t_{0}(k)      + \sum_{i=1}^{N_{T}} t_{i}(k)      r^{i} &\isdef \ctr{T}_{k}(r)\label{eq:LPMTaylorTransient}
\end{align}
where $\delta_{i}(k)$ and $t_{i}(k)$ are the (complex-valued) coefficients of the local polynomials $\ctr{\Delta}_{k}$ and $\ctr{T}_{k}$.
We denote these parameters associated with the \gls{LPM} as $\lpm{N_W,N_B,N_T}$.
Around each frequency bin $k$, $\delta_{i}(k)$ and $t_{i}(k)$ are obtained by fitting \eqref{eq:sysDeltaFiniteDataFD}  in least-squares sense with \eqref{eq:LPMTaylorSystem} and \eqref{eq:LPMTaylorTransient} substituted.
Thereby minimizing the local (linear least-squares) cost function 
\begin{equation}
  \sum_{r=-N_W}^{N_W} \left| Y_{\Delta}(k+r) - \ctr{\Delta}_{k}(r) U_{\Delta}(k+r) - \ctr{T}_{k}(r) \right|^2 \text{.}
  \label{eq:costLxM}
\end{equation}

At the edges  of the frequency grid (where $k \leq N_{W}$ or $k \geq \frac{N}{2} - N_{W}$), the local window index $r$ becomes degenerate.
This can be tackled by using e.g. an asymmetric window around $k$ as is done in \citep{Pintelon2010LPM1} or by exploiting the periodicity of the \gls{DFT} over the frequency \citep{McKelvey2012LRM}.
In this paper, we limit the notation to the `bulk' of the frequency grid to enhance the presentation of the formulas, and tacitly use the former approach in the actual computation.

Several remarks are appropriate.
\begin{itemize}
\item In typical applications of the \gls{LPM}, mainly the parameters $\delta_0(k)$ and $t_0(k)$ are of interest, as they are an improved estimate of the \gls{FRF} $\Delta(\omega_k)$ and the spectrum of the leakage $T_{\Delta}(\omega_k)$. 
In contrast, in the proposed approach in this paper, all $\delta$ parameters are of interest to interpolate the \gls{FRF} in-between the frequency grid.
\item The $\lpm{N_W,N_B,N_T}$ is used such that the local fit retains some degrees of freedoms: i.e. $2 N_W + 1  - (N_B + N_T + 2) > 0$.
\item The separation between $\Delta$ and $T_{\Delta}$ in \eqref{eq:sysDeltaFiniteDataFD} imposes requirements on the input signal. 
These requirements essentially imply that this is only possible if the input spectrum $\mat{U(\omega_{{k-N_{W}}}) & \cdots & U(\omega_{{k+N_{W}}})}$ is sufficiently `rough' over all frequencies. 
Importantly, this is the case for random noise and random phase multisines \citep{Schoukens2009LPM}.
\item Although the \gls{LPM} is illustrated for the \gls{SISO} generalized \gls{OE} case, it can be extended to work for \gls{MIMO} systems, with feedback and within the \gls{EIV} framework as is done in \citep{Pintelon2010LPM1,Pintelon2010LPM2}.
For a more detailed exposition of the \gls{LPM}, we also refer to \citep{Schoukens2006LPM, Schoukens2009LPM, Gevers2011LPM}.

\end{itemize}

\subsection{The \glsentrydesc{LRM}}
The \gls{LRM} builds upon the same basic idea of the \gls{LPM}, namely that the transfer function and transient contribution in \eqref{eq:sysDeltaFiniteDataFD} are `structured' over frequency.
Instead of using polynomials to capture the local structure, rational models are used as an approximation \citep{McKelvey2012LRM}.
 
In equation \eqref{eq:sysDeltaFiniteDataFD} that is fitted locally, the different factors $\Delta(\omega_k)$ and $T_{\Delta}(\omega_k)$ are expanded into rational functions instead of polynomials:
\begin{align}
  \Delta(\omega_{k+r})     &\approx \frac{\sum_{i=0}^{N_{B}} b_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}} = \frac{B_k(r)}{A_k(r)} &\isdef \ctr\Delta_{k}(r)\label{eq:LRMTaylorSystem} \\
  T_{\Delta}(\omega_{k+r}) &\approx \frac{\sum_{i=0}^{N_{T}} t_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}}  =  \frac{T_k(r)}{A_k(r)}&\isdef \ctr{T}_{k}(r)\label{eq:LRMTaylorTransient}
  \text{.}
\end{align}

We denote $\lrm{N_W,N_B,N_A,N_T}$ to be the \gls{LRM} with the orders and bandwidth defined above.
Similarly to the \gls{LPM}, these equation can be written in a matrix formulation for every frequency.
The resulting linear least-squares problem is closely related to the approach of \cite{Levy1959}.

\section{Local Models for \Hinf{} norm estimation}
\label{sec:LPMHinf}
In the previous section, the \gls{LPM} and \gls{LRM} have been shown to offer a way to estimate the error-system transfer function $\Delta$ with a reduced influence of the transient term $T_{\Delta}$. Essentially, this is achieved by approximating $\Delta$ and $T_{\Delta}$ around frequency bin $k$ by the low-order local models $\ctr{\Delta}_{k}$ and $\ctr{T}_{k}$, being either polynomial or rational functions.
In this section the use of the LPM and LRM is extended towards an approach that exploits these estimated local models to obtain a more fine-grained view of the error-system $\Delta$ specifically geared towards determining $\norm[\infty]{\Delta}$.

Remember that evaluating the local model $\ctr\Delta_{k}(r)$ corresponds to the value of $\Delta$'s \gls{FRF} in the frequency $\omega_{k+r}$ as captured by the local model around $\omega_{k}$.
To ease the notation, denote
\begin{equation}
  \Delta_{k}(\omega_{k+r}) \isdef \ctr{\Delta}_{k}(r) \text{.}
\end{equation}

As only a discrete grid of $\omega_k$s is available, the \Hinf{} norm \eqref{eq:HinfNormSISO} based on those measurements is
\begin{equation}
  \gamma_{\mathrm{FRF}} 
    \isdef \max_{\omega_k} \abs{\Delta\left( \omega_k \right)}  
    < \infnorm{\Delta} = \gamma
  \label{eq:gammaFRF}
\end{equation}
where the discrete grid entails in an underestimate of $\gamma$ due to the intergrid error, see also \figref{fig:exampleFRF}.

This raises the question what $\left|\Delta(\omega)\right|$ should be for any value $\omega$ not on the grid.
Using the \gls{LPM}/\gls{LRM}, we notice that for every $\omega$ within the excited frequency grid, two local models that are adjacent to $\omega$ can be found.
We denote those adjacent local models as $\Delta_{k_L(\omega)}$ and $\Delta_{k_R(\omega)}$.
Note that these models are based on the input/output spectra in the vicinity of $\omega$, hence due to their local validity additional information can be extracted regarding the value of $\Delta(\omega)$.
Since they are expressed in a parametric formulation (\eqref{eq:LPMTaylorSystem} for \gls{LPM}, \eqref{eq:LRMTaylorSystem} for \gls{LRM}), these can be evaluated locally for a continuous frequency range $\omega$.

With respect to estimating $\abs{\Delta}$ in the \Hinf{} norm \eqref{eq:HinfNormSISO}, this means that we have two candidate values that carry information: $\abs{\Delta_{k_L(\omega)}(\omega)}$ and $\abs{\Delta_{k_R(\omega)}(\omega)}$. In view of the worst-case nature of the \Hinf{} norm, a suitable solution is to use the largest value: $\max \set{\abs{\Delta_{k_L(\omega)}(\omega)}, \abs{\Delta_{k_R(\omega)}(\omega)}}$.

This leads to the following expression for estimating $\infnorm{\Delta}$ based on the local models:
\begin{equation}
  \widehat{\norm[]{\Delta_{\mathrm{LxM}}}}_{\infty} \isdef \max_{\omega} \max \set{\abs{\Delta_{k_L(\omega)}(\omega)}, \abs{\Delta_{k_R(\omega)}(\omega)}}
  \label{eq:gammaInterpolOptim}
  \text{.}
\end{equation}

Instead of formally optimizing \eqref{eq:gammaInterpolOptim} over the frequency $\omega$, this expression can be approximated arbitrarily well by evaluating the expression on a sufficiently dense frequency grid.
This is the approach we use in the implementation.

\section{Simulation Example Revisited}
\label{sec:simulation}
In order to get a clear idea of the performance of this method, we illustrate it applied to a simple discrete-time resonant second-order system.
This corresponds to the example given in Section~\ref{sec:example}, as depicted graphically in \figref{fig:DeltaOpenLoop}.

If we now take a closer look at the results for $\lrm{5,2,2,2}$ and $\lpm{3,2,2}$ for this example as shown in \figref{fig:exampleFRF}, we can see that the \gls{LPM} is not well-suited to operate in this setting.
Since there are very little points near the resonance, and a local polynomial model has a hard time capturing the resonant pole, the obtained \gls{FRF} estimate is unreliable. 
Consequently, the estimated \Hinf{} norm based on the interpolated local parametric model also is unreliable.
These observations are corroborated by the results in \citep{Schoukens2013LPMerror}, where it is shown that the \gls{LPM} requires seven points within the $3 \unit{dB}$ bandwidth of the resonance for a reliable estimate.

In sharp constrast, it can be observed in \figref{fig:exampleFRF} that the \gls{LRM} is able to model the resonance well and yields a great estimate $\infnorm{\Delta_{\mathrm{LRM}}} = 25.68 \unit{dB}$ in the simulation, where the theoretical value is $\infnorm{\Delta} = 25.69 \unit{dB}$.
This can be attributed to the fact that the \gls{LRM} uses a rational model to locally approximate the actual $\Delta$, which means that the (resonant) pole is estimated and used to obtain a local estimate of $\hinfnorm{\Delta}$. These results confirm the advantages of the proposed method in uncertainty modeling for robust control design purposes.

\section{Application to an \glsentryname{AVIS}}
\label{sec:measurement}
The proposed method is illustrated on the \gls{AVIS} shown in \figref{fig:avis}.
The \gls{AVIS} consists of a support fixed to the ground and a payload platform, suspended on airmounts, that is free to move in six degrees of freedom.
Moreover, the \gls{AVIS} is equipped with six geophones measuring the velocity and eight linear motors allow to actively compensate for vibration of the platform.

\begin{figure}
  \centering
  \includegraphics[width=0.85\columnwidth]{avis}
  \caption{\Glsfirst{AVIS}.}
  \label{fig:avis}
\end{figure}

To facilitate the presentation, only the vertical translation is considered, i.e., a \gls{SISO} error system is considered.

\subsection{Control Framework}
\label{sec:control}
The \gls{AVIS} should be in closed-loop for experimentation, see \figref{fig:tpc}. 
To implement the approach in this paper, a suitable uncertainty structure is employed that addresses the closed-loop operation of the system. 
In particular, the so-called dual-Youla framework is adopted \citep{Hansen1989,Anderson1998}. 

\begin{figure}
 \centering
 \input{figures/tpcrobust.tikz}
 \caption{The considered feedback configuration $T(\ModelSet[],C)$ with controller $C$ and plant model set $\ModelSet[]$.}
 \label{fig:tpc}
\end{figure}

In particular, an experimental controller $C = C^{\mathrm{exp}} $ decomposed into a \gls{RCF}: $C = N_c D_c^{-1} $ is assumed available.
The plant model set $\mathcal{P}$ consists of a nominal model $\hat{P} = \hat{N} \hat{D}^{-1}$, also decomposed into an \gls{RCF}, and the model error $\Delta$ which has the focus in this paper. 

This leads to a model set $\ModelSet[]$ (as shown in \figref{fig:dualYoula}) that is described by
\begin{equation}
  \ModelSet[] \isdef \set{\left. \frac{\hat{N} + D_c \Delta}{\hat{D} - N_c \Delta} \right| \hinfnorm{\Delta} \leq \gamma_{\ModelSet[]}  }
  \label{eq:dualYoulaModelSet}
  \text{,}
\end{equation}
where $\gamma_{\ModelSet[]}$ is the \Hinf{} norm that is to be estimated.
To do so, the signals $u_{\Delta}$ and $y_{\Delta}$ in \figref{fig:dualYoula} are required.
For the dual-Youla structure, it can be shown that $u_{\Delta}$ can be determined noiselessly and $y_{\Delta}$ is also accessible, but is disturbed by noise \citep{Anderson1998}.
This means that $\Delta$ in \figref{fig:dualYoula} can be estimated in an open-loop setting equivalent to \figref{fig:DeltaOpenLoop} in the problem formulation.

\begin{figure}
 \centering
 \input{figures/dualYoula.tikz}
 \caption{Dual-Youla parametrization of the closed-loop set-up  with controller $C$, plant model set $\mathcal{P}$ and nominal plant model $\hat{P}$.}
 \label{fig:dualYoula}
\end{figure}

\subsubsection{Remark}
If we consider the robust control criterion
\begin{equation}
  J(P,C) \isdef \infnorm{W T(P,C) V}
  \label{eq:controlCrit}
\end{equation}
with weighting filters $W$ and $V$, well-chosen \glspl{RCF} of $\hat{P}$ and $C$ allows to connect the identification of $\hat{P}$ and the control performance \eqref{eq:controlCrit} as in \citep{Oomen2012SIRP}.
This is the approach we follow to construct $\hat{P}$ and all relevant \glspl{RCF}.

In that setting, it can be shown that when a robust controller $C^{\mathrm{R}}$ is designed given $\ModelSet[]$, both the plant identification and control design step aim to optimize the control criterion \eqref{eq:controlCrit}.
An interesting result is that the control performance of the actual plant $P_0$ can be upper-bounded:
\begin{equation}
  J(P_0,C^{\mathrm{R}}) \leq J(\hat{P}, C^{\mathrm{exp}}) + \gamma
  \text{,}
\end{equation}
which shows that in this setting the knowledge of $\gamma = \infnorm{\Delta}$ gives valuable control performance guarantees for the actual plant $P_0$.
This also shows that even for a weighted control criterion \eqref{eq:controlCrit}, there is no need to consider a weighted $\infnorm{W' \Delta V'}$ in the control design, when a suitable model structure is chosen.

\subsection{Results}
\label{sec:resultsAvis}
We determine a (global) control-relevant parametric model $\hat{P}$ directly in the coprime factorization described in the previous section. 
We measure the \gls{FRF} using a random phase quasi-logarithmic multisine \citep{Geerardyn2013TIM} applied to the $r_1$ input of the closed-loop system (keeping the set-point $r_2 =0$).
The experimental controller $C^{\mathrm{exp}}$ was designed using classical PID rules.
In this experiment five periods of the $65\,536$ points long multisine are measured at a sampling frequency of $1\unit{kHz}$.
Only $1550$ bins are excited in such a way that $\omega_k \approx 1.001 \omega_{k-1}$.
An eigth-order parametric model $\hat{P}$ (\figref{fig:avis-frf}) is fitted using the coprime factor identification described by \cite{Oomen2012SIRP}, which optimizes a criterion alike \eqref{eq:controlCrit}.
This $\Hinf$ criterion accentuates high gains in the misfit of the coprime factors, which explains the seemingly bad fit around $100 \unit{Hz}$ in \figref{fig:avis-frf}.
The chosen model provides a reasonable description of the plant, while  some unmodeled dynamics end up in $\Delta$.
Next, $\Delta$ is identified non-parametrically by applying the multisine and calculating the $u_{\Delta}$ and $y_{\Delta}$ given the estimated $\hat{P}$ and known $C^{\mathrm{exp}}$.

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.9\columnwidth}
    \setlength{\figureheight}{0.8\figurewidth}
    \input{figures/avis-frf.tikz}
 \caption{Measured \gls{FRF} (\ref{m2t:plantFRF}) and fitted model $\hat{P}$ (\ref{m2t:plantModel}) of the \gls{AVIS}.}
 \label{fig:avis-frf}
\end{figure}

To test the methods on a low-resolution frequency grid, we use only one out of four excited bins to estimate the $\lrm{6,2,2,2}$ of $\Delta$ and apply the proposed interpolation \eqref{eq:gammaInterpolOptim}.
The \gls{LRM} applied to the full frequency resolution data is used as validation for the method.
The results are shown in \figref{fig:avisMeas} for the whole frequency band and \figref{fig:avisMeasZoom} for a frequency range where two resonances are observed and where the results of $\lpm{4,2,2}$ are shown for the sparse frequency grid.
With the proposed method in mind, it is more informative to observe how the peak values of the different parasitic resonances in $\Delta$ are handled, as these affect $\hinfnorm{\Delta}$, instead of focusing on the global value of $\hinfnorm{\Delta}$ as sole criterion.

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.9\columnwidth}
    \setlength{\figureheight}{0.8\figurewidth}
    \input{figures/avis-delta-full.tikz}
 \caption{Measured (dual-Youla) $\Delta$ for the \gls{AVIS} using the \gls{LRM} and the proposed interpolation. The data in the rectangle is also shown in \figref{fig:avisMeasZoom}.}
 \label{fig:avisMeas}
\end{figure}

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.9\columnwidth}
    \setlength{\figureheight}{0.8\figurewidth}
   \input{figures/avis4.tikz}
 \caption{Measured $\Delta$ for the \gls{AVIS} using the \gls{LRM} and the proposed interpolation. Clearly, the \gls{LRM} leads to a higher peak value, especially at $328\unit{Hz}$. The validity of the LRM local parametric model is confirmed by the validation measurement at the dense frequency grid, which reveals excellent interpolation properties. }
 \label{fig:avisMeasZoom}
\end{figure} 

There are two important aspects that we examine for the studied methods.
First, it should be asserted how the interpolation compares with the validation data.
Secondly, the estimated peak values of the individual resonances are of interest to determine whether an improved $\hinfnorm{\Delta}$ could be obtained by inspecting the intergrid behavior.

\subsubsection{Interpolation performance}
In \figref{fig:avisMeas} we can see that the estimation and validation data for \gls{LRM} are generally in agreement.
By having a look at \figref{fig:avisMeasZoom}, we can see that around both resonances the \gls{LRM} interpolation method agrees really well with the validation data.
In that frequency range, the relative difference between the interpolated data and the validation data is about $2\%$.
For the \gls{LPM} data points on the other hand, it can be seen that the \gls{LPM} estimates are validated in the `flat' regions of the \gls{FRF}.
Near the resonances the \gls{LPM} performs unreliably as a zero-only model (i.e. a polynomial) is not flexible enough to describe a lightly-damped pole well in the local bandwidth.
This drawback can be mitigated by increasing the frequency resolution \citep{Schoukens2013LPMerror}, thereby increasing the measurement time considerably.
Interpolation using the \gls{LRM} approximates the actual $\Delta$ very well and might also provide a better estimate of the peak values.

\subsubsection{Estimate of the peak value}
We examine both resonances in \figref{fig:avisMeasZoom} to inspect the peak values in more detail.
For the resonance near $296\unit{Hz}$ (in the left call-out), only a modest increase of $1.4\unit{dB}$ of the peak value to $-14.0 \unit{dB}$ is obtained using the interpolation.
This can be attributed to the nearest on-grid data point where $\abs{\Delta} = -15.3 \unit{dB}$, which is also observed in the validation data.

The other resonance at $328\unit{Hz}$ in the right call-out, however, shows a more substantial improvement.
There, it can be observed that peak is estimated at $-2.5\unit{dB}$ using the \gls{LRM} with interpolation.
In the validation data, the nearest point shows an amplitude of $-3.2\unit{dB}$ (about $8\%$ difference), which shows that the estimated peak agrees well with the validation data.
Moreover, if we compare the estimated peak value in that resonance with the nearest data point in the estimation data, we get an idea of the improvement that is obtained by interpolation.
The nearest on-grid data point has an amplitude of $-9.9 \unit{dB}$; so this amounts to an improvement of $7.4\unit{dB}$ for the peak value by means of interpolation of exactly the same data record.

This suggests that the local rational models with interpolation are a very reasonable approximation to the actual $\Delta$ and also to estimate $\hinfnorm{\Delta}$ even if the actual peak does not coincide with the discrete frequency grid.

\section{Conclusion and further research}
\label{sec:conclusion}
High performance, non-conservative robust control design requires an accurate estimate of the \Hinf\ norm of the model error $\Delta$.
In this paper, a new approach is presented that employs so-called local parametric \gls{LRM} models that lead to an enhanced estimate of $\norm{\Delta}$ of a \gls{SISO} error system by interpolating between neighboring local models. 
In addition, it is illustrated that the \gls{LPM} is not flexible enough to handle sharp resonances using very few data points.
The \gls{LRM} on the other hand is better suited for that case and is therefore the advisable solution to obtain a better estimate.
The technique is illustrated on a simulation example where the \gls{LRM}-based interpolation was able to retrieve the true $\Hinf{}$ norm.
Using measurements on an \gls{AVIS}, it is illustrated that the interpolation-based results can substantially improve $\hinfnorm{\Delta}$.
Furthermore, the results are validated by a detailed validation measurement. 
Ongoing research focuses on extending the technique to \gls{MIMO} systems and the study of its stochastic properties.

%TODO: acknowledgments reviewers

\bibliography{biblio/references,biblio/ownWork} 
%\bibliographystyle{ifacconf}

\end{document}
