\chapter{Non-parametric Peak Modeling}
\label{sec:hinf}
\chapterBasedOn{Geerardyn2014IFAC,Geerardyn2014ISMA}
\def\thisDir{ch04-lrmhinf}
\tikzsetfigurename{ch04fig}
\myEpigraph{Design is not just what it looks like and feels like. Design is how it works.}{Steve Jobs}{}
\glsresetall{}

\newcommand{\wnValue}{\ensuremath{0.95 \unit{rad/s}}}
\newcommand{\dampingValue}{\ensuremath{0.025}}
\newcommand{\TsValue}{\ensuremath{1 \unit{s}}}

\section{Introduction}
\label{sec:lrmhinf:intro}
For mechatronic design and many other engineering disciplines it is important to obtain good  models that approximate the physical reality.
Recent trends in many disciplines have led to increasingly complicated systems.
Consequently, building a full-complexity parametric model rapidly becomes disproportionately expensive for a required model fidelity.
Often, such parametric models are required to understand elementary properties of the system such as the resonance frequencies, damping of different poles, the maximal gain of the system.
In this chapter, we will investigate the use of the local parametric approaches to extract such basic information from the system without having to build a full parametric model.
The approach that is followed in this chapter is applied to estimating the \Hinf{} norm of the transfer function of a system.
This is a problem that is important in the design of robust controllers~\citep{Oomen2016} to characterize the effect of unmodeled dynamics in low-complexity models used for control.
Such analysis allows one to verify that the eventually designed controller stabilizes the system.

Robustness is of key importance in feedback controlled systems, since feedback can lead to performance degradation or even closed-loop instability.
An important example includes an \gls{AVIS}, where feedback is used to isolate high-precision equipment from external disturbances. 
The underlying feedback control principle is skyhook damping~\citep{Karnopp1995,Collette2011}. 
However, the performance of skyhook damping is limited by high-frequent lightly-damped parasitic resonance phenomena.
Such model uncertainties can be taken into account explicitly in a robust control design~\citep{Zhang2005HybridAvis} for approaches based on \Hinf{} optimization.
However, the uncertainty estimation in these references is based on rough prior assumptions and may be inaccurate. 
On the one hand, this can lead to potentially dangerous results, since no stability and performance guarantees can be given if the estimated uncertainty is too small. 
On the other hand, this can also lead to overly conservative controllers if the estimated uncertainty is too large.

Several approaches have been developed to determine bounds on the model uncertainty. 
First, model validation techniques have been developed~\citep[see e.g.][]{Smith1992,Xu1999}.
However, these results are typically overly optimistic~\citep{Oomen2009UncEstim}.
Second, model error modeling approaches based on parametric system identification~\citep{Ljung1999MEM} with explicit characterization of bias and variance errors have been proposed, but these require a significant amount of user intervention.
Third, non-parametric identification approaches have been adopted~\citep[][see e.g.]{vandeWal2002,deVries1994}. 
In~\citet{vandeWal2002}, an identified frequency response function is used directly to evaluate the \Hinf{} norm on a discrete frequency grid. 
In~\citet{deVries1994}, an extended method is presented that bounds the error in between frequency points in a worst-case fashion. 
However, such worst-case methods are well-known to be overly conservative~\citep[Section 9.5.2]{Vinnicombe2001}. 
Fourth, recently a data-driven \Hinf{} norm estimation has been developed in \citet{Wahlberg2010,Oomen2014ILH}.
These methods rely on a sequence of iterative experiments and directly deliver an estimate of the \Hinf{} norm, and combine an optimal experiment design while essentially taking inter-grid errors into account.
A recent application of this method in \citet{Oomen2014ILH} has revealed that these iterative methods lead to significantly more accurate \Hinf{} estimates compared with traditional frequency response-based methods, thereby underlining the importance of the inter-grid error.
Unfortunately, these methods require a sequence of dedicated iterative experiments.
This increases the measurement time significantly, especially for \gls{MIMO} plants.
When measurement time is expensive, this is a severe impediment.

Although important steps have been made in model-error-modeling, existing methods involve a trade-off between accuracy, measurement time, and user intervention.
The aim of this chapter is to develop a golden mean between traditional non-parametric techniques (third approach) and a full parametric model (second approach).
The proposed $\Hinf{}$ norm estimation procedure exploits recent developments in frequency domain estimation using the \gls{LPM} \citep{Schoukens2009LPM} and the \gls{LRM} \citep{McKelvey2012LRM} as introduced in \citet{Geerardyn2014IFAC,Geerardyn2014ISMA}.
Before, these \gls{LPM} and \gls{LRM} techniques have been used to enhance at-grid frequency response estimates.
Here, these methods are extended to provide both an at-grid and inter-grid evaluation of the maximum singular value near resonances, as is required for the $\Hinf{}$ norm and consequently the design of robust controllers.
The performance of these local parametric models in the context of robust control design is investigated, and bounds on the required measurement time to obtain a reliable estimate of the \Hinf{} norm are obtained.

\paragraph*{Outline}
\label{par:lrmhinf:toc}
The problem is formulated in \secref{sec:lrmhinf:Problem}.
In \secref{sec:lrmhinf:LPMHinf} the proposed method to estimate the $\Hinf{}$ norm by means of the \gls{LRM} is introduced.
In \secref{sec:lrmhinf:simulation} the method is illustrated on simulations, and the required measurement time is determined.
The technique is demonstrated on measurements of an \gls{AVIS} in \secref{sec:lrmhinf:measurement}.
Finally, the results and some challenges are discussed in \secref{sec:lrmhinf:conclusion}.

\section{Problem Formulation}
\label{sec:lrmhinf:Problem}
Robust control based on \Hinf{} optimization requires a nominal parametric model $\estimated\Plant$ and a bound on the model error $\Delta$. 
After the model $\estimated\Plant$ is determined, either through first principles modeling or system identification, it remains to determine a bound on the model error $\Delta$.
The \Hinf{} norm of the error system $\Delta$ is
\begin{equation}
  \gamma 
     = 
       \infnorm{\Delta} 
    \isdef 
       \sup_{\omega} 
         \svdMax{\Delta(\omega)}
  \label{eq:lrmhinf:HinfNorm}
\end{equation}
for a stable system where $\svdMax{\placeholder}$ denotes the maximum singular value of $\placeholder$.
Note that for \gls{SISO} systems, $\svdMax{\Delta} = \abs{\Delta}$ and the definition above reduces to
\begin{equation}
  \gamma 
    = 
       \infnorm{\Delta} 
    \isdef 
         \sup_{\omega} 
         \abs{\Delta(\omega)}
  \text{ for \gls{SISO} systems}
  \text{.}
  \label{eq:lrmhinf:HinfNormSISO}
\end{equation}
In robust control design methodologies, such \Hinf{} norms often play an important role to specify the `size' of a model class for which the controller that is to be designed should meet certain requirements~\citep{Skogestad2005}.

\begin{remark}
It is even more common to use a weighted norm $\infnorm{W \Delta V}$ in robust control designs where $(W,V)$ are stable and minimum-phase weighting filters.
Two use cases can be distinguished: either these filters are chosen by the control engineer and hence known, or, one wishes to construct such filters from data.
In the case where the weighting filters are `known', the approach of this chapter can be adapted in a straightforward manner to account for these weights, i.e., by replacing $\svdMax{\Delta}$ with $\svdMax{W \Delta V}$ in the formulas.
The other case is explained in Remark~\ref{rem:lrmhinf:constructWeights}.
\end{remark}

To estimate $\gamma$, only $\Delta(\omega_{\star})$ is of interest, where
\begin{equation}
 \omega_{\star} 
     \isdef 
       \arg
         \sup_{\omega} 
           \svdMax{\Delta(\omega)}
  \text{.}
  \label{eq:lrmhinf:omega-star}
\end{equation}
If the measurement time is finite, non-parametric approaches only give access to a finite and discrete grid of frequencies $\omega_k \in \DFTGrid $, i.e. $\DFTGrid \isdef \set{\omega_1, \omega_2, \ldots, \omega_{N-1}}$.
Typically, this discrete grid is the frequency grid of the \gls{DFT}.
As such, \eqref{eq:lrmhinf:HinfNorm} can be rewritten as
\begin{equation}
  \gamma \isdef 
    \sup_{\omega} 
      \svdMax{\Delta(\omega)}
         = \max 
             \Set{
                \max_{\omega \in \DFTGrid  } 
                  \svdMax{\Delta(\omega)}
                \;,\;
                \sup_{\omega \in \InterGrid} 
                  \svdMax{\Delta(\omega)}
                }
  \label{eq:lrmhinf:gamma-split-grid}
  \text{.}
\end{equation}
For convenience, we extract both contributions above as:
\begin{align}
  \gammaAtGrid & \isdef 
    \max_{\omega \in \DFTGrid  } 
      \svdMax{\Delta(\omega)}
  \label{eq:lrmhinf:gamma:atGrid}\\
  \gammaIntergrid & \isdef 
    \sup_{\omega \in \InterGrid} 
      \svdMax{\Delta(\omega)}
   \label{eq:lrmhinf:gamma:interGrid}
\end{align}
where $\Omega \isdef \OpenInterval{0,\frac{2\pi}{\Ts}}$ is the measured frequency range for a sampling time $\Ts$.
Direct inspection of the \gls{FRF} data only allows access to $\gammaAtGrid$.
Two cases can be distinguished:
\begin{enumerate}
  \item $\omega_{\star} \in \DFTGrid$ such that $\svdMax{\Delta(\omega_{\star})} = \gamma =\gamma_{\FRF}$ is observed directly on the discrete frequency grid,
  \item $\omega_{\star} \not\in \DFTGrid$, i.e. the extremal value $\svdMax{\Delta(\omega_{\star})}  = \gamma = \gammaIntergrid$ is determined by the \gls{IG} behavior.
\end{enumerate}

The use of $\gamma_{\FRF}$ is standard in \gls{FRF}-based approaches, e.g.~\citet{vandeWal2002}.
However, when the measurement time is finite, the expected value of  $\gamma_{\FRF}$  for different realizations of the input signal and noise, may underestimate the actual peak gain $\gamma$, i.e. $\expectedValue{\gammaAtGrid} \leq \gamma$.
This is due to the limited frequency resolution imposed by the measurement time: the frequency where the actual peak gain occurs might not coincide with the excited frequency grid.
Such an underestimate of $\gamma$ leads to overly optimistic controller designs which in turn can cause unstable behavior of the plant.

The main contribution of this chapter is to  estimate the inter-grid term $\gammaIntergrid$ without the need for a (global) parametric model or imposing worst-case prior knowledge that leads to conservatism.
Instead, a  realistic value of $\gamma$ is obtained using parametric models that are valid over a finite frequency range.

\subsection{Set-Up}
Consider an output error \gls{LTI} discrete-time \gls{SISO} system $\Delta(q)$ excited by an input signal $u_{\Delta}(n)$.
This can be described in the time-domain as
\begin{equation}
  y_{\Delta}(n) 
    = 
      y_{\Delta0}(n)
      + v(n) 
    = 
      \Delta(q)u_{\Delta}(n) 
      + H(q)e(n)
  \label{eq:lrmhinf:sysDeltaInfData}
\end{equation}
where $q^{-1}$ is the lag operator, $e(n)$ is white Gaussian noise with unity variance such that $v(n) = H(q)e(n)$ can be colored noise, and both $\Delta(q)$ and $H(q)$ are stable causal real-rational functions.
For a limited data record ($n \in \Set{0,\ldots,N-1}$ with $N$ the number of data points), the transient contributions $t_{\Delta}(n)$ lead to:
\begin{equation}
    y_{\Delta}(n) 
      = 
        \Delta(q)u(n) 
        + H(q)e(n) 
        + t_{\Delta}(n)
    \text{.}
    \label{eq:lrmhinf:sysDeltaFiniteData}
\end{equation}
By applying the \gls{DFT}
\begin{equation}
  X(k) 
       = 
         \frac{1}
              {\sqrt{N}} 
         \sum_{n=0}^{N-1} 
            x(n) \exp \left( \frac{- j 2 \pi k n }{N} \right)
         \quad   
         \forall k \in \mathbb{Z}
  \label{eq:lrmhinf:DFT}
\end{equation} 
to both sides of~\eqref{eq:lrmhinf:sysDeltaFiniteData}, one obtains:
\begin{equation}
  Y_{\Delta}(k) 
                = 
                  \Delta(\omega_k) U_{\Delta}(k) 
                  + T_{\Delta}(\omega_k) 
                  + V(k) 
  \text{.}
  \label{eq:lrmhinf:sysDeltaFiniteDataFD}
\end{equation}
The $T_{\Delta}$ contribution models the difference between the begin and end conditions of the filters $\Delta$ and $H$ in the measurement~\citep{Pintelon1997ARB}.
The index $k$ corresponds to the $k^{\text{th}}$ frequency bin with frequency $\omega_{k} = 2\pi k / (N \Ts)$ such that the frequency grid $\DFTGrid \isdef \Set{\left.\omega_k \right| k = 1,\ldots,N-1}$.

The presented results in this paper directly extend to closed-loop systems, as is shown in \secref{sec:lrmhinf:control}.
The results in this chapter are presented in discrete time, but the extension to the continuous time case is straightforward.

\section{\Hinf{} Norm Estimation Procedure}
\label{sec:lrmhinf:LPMHinf}
To estimate $\gammaIntergrid$, we propose to identify local parametric models in the frequency domain.
The frequency axis is partitioned into continuous segments $\Omega_k \isdef \ClosedInterval{ \omega_{k-1} , \omega_{k+1} }$ in view of the local validity of the local models.
In particular, the inter-grid aspect of the $\Hinf$ norm is estimated as
\begin{equation}
  \gammaIntergrid = 
    \sup \Set{ 
                \sup_{\omega \in \Omega_k} \svdMax{\LocalModel[k]{\Delta}(\omega)}
                |
                k = 1,\ldots,N-1
                }
   \label{eq:lrmhinf:gamma-inter-grid}
\end{equation}
where the $\LocalModel[k]{\Delta}$ is the local model around the ($k^{\text{th}}$) frequency bin $\omega_k$.
An example of such local models is shown in \figref{fig:lrmhinf:interpol-quantities}.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.68\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/interpolation-show.tikz}
  \caption[Illustration of the local models.]{Illustration of the local models $\LocalModel[k]{\Delta}$ around each frequency bin $\omega_k$ for $k\in\Set{1,\ldots,6}$.
  The bottom part shows the equivalence of the frequency segments $\Omega_k$ and the intervals $\Set{\omega \given{\leftAdjacent(\omega) = k \vee \rightAdjacent(\omega) = k}}$.}
\label{fig:lrmhinf:interpol-quantities}
\end{figure}

Direct implementation of \eqref{eq:lrmhinf:gamma-inter-grid} allows a simple and efficient evaluation of $\gammaIntergrid$ that matches well to parallel computation frameworks such as \code{MapReduce}~\citep{Dean2008}.
In particular, the inner $\sup_{\omega\in\Omega_k}$ can be understood as a \code{map} operation that maps a local model to its peak value and the outer $\sup$ is a \code{reduce} that only retains the global peak value given the peak value of each local model.
Unfortunately, such an implementation offers no access to the behavior of $\svdMax{\Delta(\omega)}$, e.g. around the peak amplitude.

\paragraph{Interpolation method}
To allow inspection of $\svdMax{\Delta(\omega)}$ in~\eqref{eq:lrmhinf:HinfNormSISO} for arbitrary values of $\omega \in \Omega$, we propose an interpolation approach to estimate $\gamma$ and to allow visual inspection of $\svdMax{\Delta(\omega)}$.
It can be understood intuitively that due to the limited validity domain of the local models, an estimate of $\Delta(\omega)$ can only be obtained from $\LocalModel[k(\omega)]{\Delta}$ when the distance $\abs{\omega_k-\omega}$ is small.
As the local models are each constructed around the frequency $\omega_k$, for an arbitrary $\omega \in \Omega$, one can find two adjacent frequencies around which such local models are available.
To this end, two functions that indicate respectively the left and the right adjacent local models for frequency $\omega \in \Omega$ are defined:
\begin{align}
  \leftAdjacent(\omega) & 
                \isdef
                  \max
                  \Set{
                    k 
                    |
                      \omega_k \in \DFTGrid,  \omega_k \leq \omega
                  }\\
  \rightAdjacent(\omega) & 
                \isdef
                  \min
                  \Set{
                    k
                    |
                      \omega_k \in \DFTGrid,  \omega_k \geq \omega
                  }
  \text{.}
  \label{eq:lrmhinf:kL-kR-indexing-functions}
\end{align}
Using the $\leftAdjacent(\omega)$ and $\rightAdjacent(\omega)$ functions, two candidate values for $\svdMax{\Delta(\omega)}$ are obtained:
\begin{equation*}
 \svdMax{\LocalModel[\leftAdjacent(\omega)]{\Delta}(\omega)} 
 \quad \text{ and } \quad
 \svdMax{\LocalModel[\rightAdjacent(\omega)]{\Delta}(\omega)}
\end{equation*}
In view of obtaining the maximum singular value, these are `interpolated' to obtain a single estimate:
\begin{equation}
  \svdMax{\Delta_{\LMM}(\omega)}
    \isdef
    \max \Set{
       \svdMax{\LocalModel[\leftAdjacent(\omega)]{\Delta}(\omega)},
        \svdMax{\LocalModel[\rightAdjacent(\omega)]{\Delta}(\omega)}
    }
    \label{eq:lrmhinf:DeltaLRMInterpolation}
\end{equation}
by retaining the largest of both.
It follows that
\begin{align}
  \widehat{\phantom{_\infty}\infnorm{\Delta_{\LMM}}}
    & \isdef
    \sup_{\omega\in\Omega}
    \svdMax{\Delta_{\LMM}(\omega)} \\
   &  =
      \sup_{\omega\in\Omega} \; 
      \max \Set{
                 \svdMax{\LocalModel[\leftAdjacent(\omega)]{\Delta}(\omega)}, 
                 \svdMax{\LocalModel[\rightAdjacent(\omega)]{\Delta}(\omega)}}
  \label{eq:lrmhinf:gammaInterpolOptim}
  \text{.}
\end{align}

\begin{remark}
The construction of $ \svdMax{\Delta_{\LMM}(\omega)}$  makes it more involved to implement the interpolation approach in an efficient and/or parallel fashion.
\end{remark}

\begin{remark}1
The notions $\svdMax{\Delta_{\LMM}(\omega)}$ and the ensuing  $\widehat{\phantom{_\infty}\infnorm{\Delta_{\LMM}}}$  should be regarded as notational convenience to denote that local models are used to estimate the maximal singular value and $\Hinf{}$ norm, respectively.
In reality, there is no tangible `$\Delta_{\LMM}$' that is constructed: neighboring local models are stitched together using the `$\max$' operator.
\end{remark}

\begin{remark}
The optimization problems \eqref{eq:lrmhinf:gammaInterpolOptim} and \eqref{eq:lrmhinf:gamma-inter-grid} each amount to one-dimensional optimization problems, hence they can be solved accurately, fast and easily by gridding the frequency $\omega$.
The peak amplitudes obtained using both implementations are identical since the local models $\LocalModel[k]{\Delta}$ are evaluated over identical frequency ranges
 \begin{equation}
  \Omega_k 
     = 
       \Set{
           \omega 
           | 
               \leftAdjacent(\omega) = k 
               \vee 
               \rightAdjacent(\omega) = k
      }
 \end{equation}
for both methods (but in different order) and aggregated using the supremum operator, which is indifferent to the order of its arguments.
In \figref{fig:lrmhinf:interpol-quantities} the functions $\leftAdjacent(\omega)$ and $\rightAdjacent(\omega)$ are visualized and the equivalence with $\Omega_k$ is apparent.
\end{remark}

\subsection{The \glsentrydesc{LRM}}
\label{sec:lrmhinf:LRM}

\disclaimer{
The \gls{LRM} and \gls{LPM} are described in \chapref{sec:nonparametric} and \citep{Schoukens2009LPM,Pintelon2010LPM1,Pintelon2010LPM2,McKelvey2012LRM} in more detail.
Below, we briefly re-iterate some pertinent aspects and notations.
}

The local models $\LocalModel[k]{\Delta}$ are estimated using the \gls{LRM}~\citep{McKelvey2012LRM}.
The \gls{LRM} exploits the fact that the transfer function $\Delta(\omega)$ and the leakage term $T_{\Delta}(\omega)$  in \eqref{eq:lrmhinf:sysDeltaFiniteDataFD} are smooth functions of the frequency.
As such, $\Delta$ and $T_{\Delta}$ are approximated locally by rational functions around each bin $k$:
\begin{align}
  \Delta(\omega_{k+r})     
    &\approx 
        \frac{\sum_{i=0}^{N_{B}} b_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}} 
      = 
        \frac{B_k(r)}{A_k(r)} 
      \isdef 
        \LocalModel[k]{\Delta}(\omega_{k+r})
      \label{eq:lrmhinf:LRMTaylorSystem} \\
  T_{\Delta}(\omega_{k+r}) 
    &\approx 
        \frac{\sum_{i=0}^{N_{T}} t_{i}(k) r^{i}}{1 + \sum_{i=1}^{N_{A}} a_{i}(k) r^{i}}  
      = 
        \frac{T_k'(r)}{A_k(r)} 
      \isdef 
        \LocalModel[k]{T}(\omega_{k+r})
  \label{eq:lrmhinf:LRMTaylorTransient}
  \text{.}
\end{align}
Its local parameters $a_{i}(k)$, $b_{i}(k)$ and $t_{i}(k)$ are estimated by considering~\eqref{eq:lrmhinf:sysDeltaFiniteDataFD} in the local window $\LocalWindow = \Set{-N_W,\ldots,+N_W}$ around each bin $k$.
This yields
\begin{equation}
  Y_{\Delta}(k+r) 
                 \approx
                    \Delta(\omega_{k+r}) U_{\Delta}(k+r) 
                    + T_{\Delta}(\omega_{k+r}) 
    \quad
    \forall r \in \LocalWindow
    \text{.}
    \label{eq:lrmhinf:LocalWindowSpectra}
\end{equation}
By substituting the local models $\LocalModel[k]{\Delta}$ and $\LocalModel[k]{T}$, one obtains
\begin{align}
  Y_{\Delta}(k+r) 
                  & \approx
                    \LocalModel[k]{\Delta}(\omega_{k+r}) U_{\Delta}(k+r) 
                    + \LocalModel[k]{T}(\omega_{k+r}) 
                    & \forall r \in \LocalWindow \\
                  & = 
                    \frac{B_k(r)}{A_k(r)} U_{\Delta}(k+r) 
                    + 
                    \frac{T'_k(r)}{A_k(r)} 
                    & \forall r \in \LocalWindow
    \text{.}
    \label{eq:lrmhinf:LocalWindowSpectraLRM}
\end{align}
To make this expression linear in the parameters $a_i(k)$, both sides are multiplied by $A_k(r)$ as in~\citep{Levy1959}.
By doing so, the local linear-least-squares cost function
\begin{equation}
  \sum_{r=-N_W}^{N_W} 
  \left| 
    A_k(r) Y_{\Delta}(k+r) - B_k(r) U_{\Delta}(k+r) - T'_{k}(r)
  \right|^2
  \label{eq:lrmhinf:localCostLRM}
\end{equation}
 around each bin $k$ can be constructed.

We denote $\lrm{N_W,\order{B},\order{A},\order{T}}$ to be the \gls{LRM} with the orders $\order{B}$, $\order{A}$, $\order{T}$ and bandwidth $N_W$ defined above.
For $\order{A}=0$ the \gls{LRM} simplifies to the \gls{LPM} which we shall denote as $\lpm{N_W,\order{B},\order{T}}$.

\begin{remark}
Since the \gls{LRM} is used to locally estimate the \gls{FRF} based on measurements, this sets a limit on the accuracy of the ensuing estimate of the peak value.
This was treated in \secref{sec:nparam:simulations}.
\end{remark}

\section{Simulation}
\label{sec:lrmhinf:simulation}
To allow the generalization of the results of the simulations, we first introduce a way to decompose complex systems into simpler systems.
The behavior of these simpler systems then allows to predict the behavior for these more complex systems.
Concretely, any proper real-rational system $\Delta$ can be decomposed in a parallel connection of lower-order sub-systems by means of a partial fraction expansion as in \eqref{eq:excitation:PFE}, i.e.
\begin{equation}
\Delta(s) = 
         \deemph{
         \sum_{i=1}^{I_1} 
          \sum_{\multiplicity=1}^{M_{1,i}} 
            \frac{\dc[i]}
                      { \left( s - \pole[i] \right)^{\multiplicity}}
            + 
        }
        \sum_{i=1}^{I_2} 
          \deemph{\sum_{\multiplicity=1}^{M_{2,i}}}
           \frac{\dc[i,\multiplicity] \wn[i]^{2\multiplicity} \left( s + \wz[i] \right)}
                     {\wz[i] \left(s^2 + 2 \damping[i] \wn[i] s + \wn[i]^2 \right)^{\multiplicity}}
\end{equation}
with the same notations as in \chapref{sec:excitation}, most importantly, each resonant pole can be characterized by its frequency $\wn[i]$ and damping $\damping[i]$.
In the structural engineering community~\citep[see e.g.][Section 2.2.2]{Gawronski2004} it is well-known that around sharp resonance peaks ($\omega \approx \wn[i]$), the shape of a structural transfer function is mainly determined by its modal transfer function.
In many practical situations, this means that the gray terms in the equation often have a negligible influence.
For local modeling, the response is hence well-approximated by only considering the poles and zeros in the local frequency window.
To estimate $\infnorm{\Delta}$ mainly the resonant sub-systems are of interest as those are responsible for large gains of the system.
Assuming such resonances are sufficiently separated in the frequency,~\citep{Schoukens2013LPMerror,Geerardyn2013TIM,Gawronski2004} show that results for a single resonance are applicable to more complex systems.
This is done by considering only the dominant resonance -- \emph{viz.} the one that is the most relevant for the $\Hinf{}$ controller design.
By normalizing the conclusions for the time constant $\timeconst$ (or the $3\unit{dB}$ bandwidth), the results are generally valid for different values of the damping $\damping$.
Specifically, the time constant $\timeconst \isdef (\damping \wn)^{-1}$ of the dominant pole dictates the required measurement time~\citep{Schoukens2013LPMerror}, where $\damping$ is the relative damping and $\wn$ the natural frequency of the dominant pole.

\subsection{A Concrete Simulation}
Consider a discrete time system $\Delta$ (see \figref{fig:lrmhinf:exampleIntergrid}) as unmodeled dynamics in an output-error setting:
\begin{equation}
  \Delta(z) 
    =  \frac{0.45373 z + 0.44752}
            {z^2 - 1.0595 z + 0.96079}
  \label{eq:lrmhinf:O2sysDT}
  \text{,}
\end{equation}
which has $\timeconst = 50 \unit{samples}$ (i.e. $\damping=0.02$ and $\wn = 1 \unit{rad/s}$).
The input signal $u_{\Delta}$ is white Gaussian noise with unit variance and the disturbing noise variance $\sigma_v^2$ is chosen such that a \gls{SNR} 
\begin{equation}
  \SNR = \frac{\sqrt{\inv{N}\sum_n y_{\Delta0}^2(n) }}%
              {\sqrt{\inv{N}\sum_n v^2(n) }}
       = \frac{\sigma_{y_{\Delta0}}}{\sigma_v}
       \approx \frac{\norm[2]{\Delta} \sigma_{u_{\Delta}}}{\sigma_v}
  \label{eq:lrmhinf:SNR}
\end{equation}
of $10$ is obtained.
In the frequency domain, this corresponds to $\SNR_{\BW} \approx 26 \unit{dB}$ in the $3\unit{dB}$ bandwidth of this resonance peak.

Classical \gls{SA} techniques~\citep{Bendat1993} can estimate the \gls{FRF} of $\Delta$.
This is done by first splitting the input and output signals ($u(n)$ and $y(n)$)  into $\nSegments$ segments of $N/\nSegments$ samples that we will denote as
\begin{equation}
  x^{[i]}(n) = x\left( (i-1) \nSegments + n \right) 
  \text{ with }
  n \in \set{0, \ldots N/\nSegments - 1}
  \text{ and }
  i \in \set{1, \ldots, \nSegments}
  \text{.}
  \label{eq:lrmhinf:SA:segmentation}
\end{equation}
Each of these segments is windowed using a function $w_{N/\nSegments}(n)$ to reduce leakage such that 
\begin{equation}
x^{[i]}_{w}(n) = x^{[i]}(n) \cdot w_{N/\nSegments}(n)
\text{.}
\end{equation}
The frequency domain counterparts are obtained by means of the \gls{DFT}, and are denoted 
\begin{equation}
X^{[i]}_W(k) = \DFT(x^{[i]}_w(n))
\text{,}
\end{equation}
where it should be noted that $k \in \set{0,N/\nSegments}$ such that the frequency resolution is $\frac{2\pi \nSegments}{N}$.
By dividing the resulting auto- and cross-spectra, the \gls{FRF} of $\Delta$ can be estimated
\begin{equation}
  \hat{\Delta}_{\mathrm{SA}}(k) \isdef 
  \frac{\frac{1}{\nSegments} \Sum_{i=1}^{\nSegments} Y_W^{[i]}(k) \conj{U_{W}^{[i]}(k)} }
           {\frac{1}{\nSegments} \Sum_{i=1}^{\nSegments} U_W^{[i]}(k) \conj{U_{W}^{[i]}(k)} }
\end{equation}
In this chapter a Hann window ($w_{N/\nSegments}(n) = \sin^2 (\frac{\pi n}{N/\nSegments -1})$) and $\nSegments=1$ are used.
Note that $\nSegments>1$  increases the measurement time by a factor $\nSegments$ to attain the same frequency resolution (but would improve transient and noise rejection).

\figref{fig:lrmhinf:exampleIntergrid} illustrates for $N=97$ that $\gamma_{\FRF}$ for the \gls{SA}, $\lpm{5,4,4}$ and $\lrm{5,2,2,2}$ approaches yield unreliable estimates of $\infnorm{\Delta}$, since the frequency resolution is too coarse.
The specific orders of  \gls{LRM}/\gls{LPM} have been chosen to  keep $N_W$ small while not restricting ourselves to local linear models ($\order{B}=1$). 
Slightly different orders (e.g. $\lrm{4,1,1,1}$) yield comparable results.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.75\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/example-both.tikz}
  \caption[Example: \glsentryshort{FRF} underestimates $\E{\gamma}$]{Simulation example revealing that $\gamma_{\FRF}$ (left) for both the \glsfirst{SA}~\legref{leg:example-SA} and \gls{LRM}~\legref{leg:example-LRM} underestimate the true $\gamma = \infnorm{\Delta} = 24$~\legref{leg:example-true-Hinf} due to limited frequency resolution.
  Using the proposed \gls{LRM}-based approach, both the at-grid~($\gamma_{\FRF}$) and intergrid~($\gammaIntergrid$) estimate are improved.
  The interpolated \gls{LRM}~\legref{leg:example-LRM-interpol} and true $\Delta$~\legref{leg:example-true} almost coincide.
  Hence, $\widehat{\infnorm{\Delta_{\LRM}}}$~\legref{leg:example-LRM-interpol-Hinf} approaches the theoretical $\gamma=24$.}
  \label{fig:lrmhinf:exampleIntergrid}
\end{figure}

It can be observed for $\gammaIntergrid$ in \figref{fig:lrmhinf:exampleIntergrid} that the \gls{LRM} is able to model the resonance well and yields a useful estimate $\infnorm{\Delta_{\LRM}} = 24$ in the simulation.
Intuitively, the \gls{LRM} locally approximates the resonant pole which allows for a reliable inter-grid estimate.
The \gls{LPM}, on the other hand, does not provide a reliable estimate.

\subsection{Study of the Experiment Length}
The frequency resolution, and hence the experiment length, is key to obtain a reliable \Hinf{} norm estimate.
In this section, we determine the minimal experiment length needed for the proposed approach by means of simulations.

We simulate the system \eqref{eq:lrmhinf:O2sysDT} for $16\,100$ samples and discard the first $2\tau=100$ samples to randomize the initial conditions.
To mimic the effect of progressively measuring longer data records, the first remaining $N$ samples are used to estimate $\infnorm{\Delta}$ as in \secref{sec:lrmhinf:LPMHinf}.
The values of $N \in \ClosedInterval{35,16\,000}$ are chosen such that $\expectedValue{\gamma_{\FRF}(N)}$ is a non-decreasing function of $N$.
This ensures that grid misalignment between the actual resonance frequency and the observed frequency grid is accounted for such that the worst-case estimate of the resonance is obtained.
These simulations are then repeated in a Monte Carlo simulation of $n_{\mathrm{MC}}=200$ runs where each run has a different realization of  $u_{\Delta}(n)$ and $v(n)$.
The resulting sample average and standard deviation $\sigma$ are shown in \figref{fig:lrmhinf:MC-run-length}.

\begin{figure}
  \centering
  \setlength{\figurewidth}{0.75\columnwidth}
  \setlength{\figureheight}{0.68\figurewidth}
  \input{\thisDir/figs/MC-runlength.tikz}
  %\input{figures/runLength.tikz}
  \caption[Estimated $\gamma$ versus measurement time.]{This Monte Carlo simulation shows that the $\Hinf{}$ norm~\legref{leg:runlength-true} is underestimated significantly for short experiments ($N<20\timeconst$) by $\expectedValue{\gammaAtGrid}$~\legref{leg:runlength-frf} and the \gls{LPM}~\legref{leg:runlength-LPM}.
  However, the proposed $\widehat{\infnorm{\Delta_{\LRM}}}$~\legref{leg:runlength-LRM} is already reliable from much shorter experiments ($N \geq 4 \timeconst$). A single observation for $N=97$~\legref{leg:runlength-special-case} is shown in \figref{fig:lrmhinf:exampleIntergrid}. The shaded areas show the $\pm \sigma$ intervals which are due to the noise.
  }
\label{fig:lrmhinf:MC-run-length}
\end{figure}

It can be seen in \figref{fig:lrmhinf:MC-run-length} that $N \geq 20\timeconst$ is required to attain a frequency grid that is dense enough to obtain a reliable $\gammaAtGrid$, i.e. $\expectedValue{\gammaAtGrid} \approx \gamma$.
Starting from about $N=4 \text{ to } 5\timeconst$, the interpolated \gls{LRM} starts to yield good estimates for $\gammaIntergrid$.
For long experiments $(N \to \infty)$, the true $\infnorm{\Delta}$ is recovered.
Practically, this implies that the interpolated \gls{LRM} beats the on-grid estimate using a data record that is only a fraction of the length.

\begin{remark} \label{rem:lrmhinf:constructWeights}
In robust control design, often the interest is not only in determining the peak value of the uncertainty, but also in obtaining a tight overbound of the uncertainty, e.g. as in \citet{Scheid1995}.
This is closely related to the design of (parametric) weighting filters $(W,V)$ such that $\abs{W \Delta V}$ is almost a constant function of the frequency in the frequency bands of interest for control design.
Essentially, this is done to ensure that a synthesized robust controller is largely invariant under the choice of uncertainty structure chosen in the model set.

The proposed local parametric approach can be extended straightforwardly to accommodate for this.
In particular, the overbound of $\Delta$ can be generated for an arbitrarily dense frequency grid---i.e. this includes the inter-grid behavior--- such that the approach of \citet{Scheid1995} can be used directly.
\end{remark}

\begin{guideline}[Measure at least $5\timeconst\,$ to observe the peak value using the local models]
\begin{minipage}{0.725\textwidth}
After $4$ to $5$ time constants of the dominant pole, the local models offer a reliable insight into the peak value of a transfer function when a sufficient \gls{SNR} of approximately $20\unit{dB}$ is available such that the \gls{LRM} can be used.
For purely \gls{FRF}-based estimates, on the other hand, the measurement only attains similar performance when measuring for $20\timeconst$.
\end{minipage}
\hfill
\begin{minipage}{0.25\textwidth}
\setlength\figurewidth{\columnwidth}
\setlength\figureheight{0.618\figurewidth}
\input{\thisDir/figs/sketch-SNR.tikz}
\end{minipage}
\end{guideline}

\section{Application to an \glsentryname{AVIS}}
\label{sec:lrmhinf:measurement}
The proposed method is illustrated on the \gls{AVIS} shown in \figref{fig:lrmhinf:avis}.
The broad aim of vibration isolation~\citep{Karnopp1995,Collette2011} is to suppress vibrations such that a certain payload---e.g. passengers in a car, sensitive equipment such as atomic force microscopes and wafer-scanners used for lithography---is not disturbed by vibrations generated by either the payload itself ($\systemDisturbance$) or by the outside world ($\externalDisturbance$) as indicated in \figref{fig:lrmhinf:vibration-isolation}.

\begin{figure}
 \centering
  \setlength{\figurewidth}{0.45\columnwidth}
  \begin{subfigure}[b]{0.49\columnwidth}
   \centering
    \input{\thisDir/figs/vibrationisolation-classical.tikz}
    \caption{Traditional set-up.}  
    \label{fig:lrmhinf:vibration-isolation:traditional}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.49\columnwidth}
    \centering
    \input{\thisDir/figs/vibrationisolation-skyhook.tikz}
    \caption{Principle of sky-hook damping.}  
    \label{fig:lrmhinf:vibration-isolation:skyhook}
  \end{subfigure}
  \disclaimer{Figure based on \citep[Fig. 3 and 4]{Voorhoeve2015SYSID} and \citep[Fig. 3 and 6]{Karnopp1995}.}
  \caption[Vibration isolation set-ups (traditional, sky-hook damping)]{Conceptual illustration of (active) vibration isolation set-ups. 
  In addition to the passive isolation (spring and damper), the active controller $C$ provides additional isolation using the measurement of the payload velocity ($y=v_z$).
  % If the velocity relative to ground is measured (a), the controller design involves trading-off which disturbance should be suppressed better.
  % When the absolute velocity the payload is measured (b), the controller can suppress both disturbances as it acts as a damper between a virtual fixed point (``sky'') and the payload.
  }
  \label{fig:lrmhinf:vibration-isolation}
\end{figure}

The typical set-up for vibration isolation is illustrated in \figref{fig:lrmhinf:vibration-isolation:traditional}.
If the controller $C$ is removed, the set-up reduces to a passive isolation system where the suspension is to be designed such that the payload velocity $y=v_z$ is influenced as little as possible by both the internal disturbances ($\systemDisturbance$) and the external disturbances ($\externalDisturbance$).
To suppress $\externalDisturbance$, a compliant suspension is required such that the payload and the floor are decoupled.
However, to enable suppression of the system disturbances $\systemDisturbance$, a stiff suspension is desirable to minimize the deflection of the payload~\citep{Voorhoeve2015SYSID}.
This obviously leads to a trade-off in the design.
In active vibration isolation, measurements of the position, velocity and even acceleration of the payload allow more freedom in tuning the suspension of the payload.
Typically, the controller $C$ acts as an additional damping term.
However, when such measurements are relative to the floor or other objects which are subject to the external disturbances $\externalDisturbance$ themselves, the trade-off for passive vibration isolation remains applicable.

On the other hand, when a measurement of the absolute velocity of the payload is available, the external disturbances can be reduced effectively.
Absolute velocity measurements can be obtained e.g. from inertial sensors such as geophones~\citep{MunnigSchmidt2014}.
In particular, such sensors suspend an inertial mass using suspension with very low resonance frequency to the payload.
By observing the relative movement of the inertial mass and the payload, the absolute velocity of the payload can be measured~\citep{Collette2011}.
Conceptually, the active controller $C$ can be seen as connected to an imaginary fixed point in the `sky' (\figref{fig:lrmhinf:vibration-isolation:skyhook}), which is not disturbed by $\externalDisturbance$ for an ideal sensor.
Consequently, the trade-off that exists in passive isolation is eliminated.
A compliant passive suspension can decouple the payload from external disturbances while the active controller acts as a stiff damper to the `sky' such that the effect $\systemDisturbance$ is suppressed.

The particular \gls{AVIS} used for the experiments, consists of a support fixed to the ground and a payload platform, suspended on airmounts (see \figref{fig:lrmhinf:avis:details}) providing passive vibration isolation.
The payload platform is able to move in six mechanical degrees of freedom.
Six geophones measure the payload velocity in an inertial reference frame, hence providing absolute velocity measurements, and eight linear motors (see \figref{fig:lrmhinf:avis:details}) allow to actively compensate for vibration of the platform using the principle of `sky-hook damping'.
Please refer to \appref{app:avis-setup} for more details regarding the mechanical set-up, placement of the sensors and the signal processing involved.
To facilitate the presentation, only the vertical translative velocity ($v_z$), i.e. a \gls{SISO} system, is considered.

\begin{figure}[p]
  \centering
  \setlength\figurewidth{0.75\columnwidth}
  \photobox{\includegraphics[width=\figurewidth]{\thisDir/figs/avis.jpg}}
  \caption{\Glsentryfirst{AVIS}.}
  \label{fig:lrmhinf:avis}
\end{figure}

\begin{figure}[p]
  \centering
  \setlength{\figurewidth}{0.475\columnwidth}
  \photobox{\includegraphics[width=\figurewidth]{\thisDir/figs/avis-airmount-cropped.jpg}}
  \hfill
  \photobox{\includegraphics[width=1.005\figurewidth]{\thisDir/figs/avis-motors-cropped.jpg}}
  \caption[\glsentryshort{AVIS} isolation module.]{Isolation module of the \glsentrytext{AVIS}. 
  The left photo shows one of the air mounts providing passive vibration isolation.
  The right photo shows two linear motors that play a role in the active vibration isolation.}
  \label{fig:lrmhinf:avis:details}
\end{figure}

\subsection{Measurement \& Control Framework}
\label{sec:lrmhinf:control}
The experiments on the \gls{AVIS} are carried out in closed-loop (\figref{fig:lrmhinf:tpc}) with $r_2 = 0$.
%TODO: define T(P,C) formally
The controller $\Controller=\experimental\Controller$ is a diagonal \gls{PI} regulator which stabilizes the \gls{AVIS} but yields only moderate vibration isolation.
See \appref{app:avis-setup} for detailed information regarding both the experimental setup and the experimental controller.
The $r_1$ input consists of five periods of a random phase multisine of $65\,536$ samples with excited bins such that $\omega_k \approx 1.001 \omega_{k-1}$  and $\Ts=1\unit{ms}$.
See \chapref{sec:excitation} and \citep{Geerardyn2013TIM} for more information regarding the design of such a signal.

\begin{figure}
 \centering
 \input{\thisDir/figs/tpcrobust.tikz}
 \caption[Closed-loop block schematic.]{The considered feedback configuration $\ClosedLoop{\ModelSet[],\Controller}$.}
 \label{fig:lrmhinf:tpc}
\end{figure}

\begin{figure}
 \centering
 \input{\thisDir/figs/dualYoula.tikz}
 \caption[Dual-Youla parametrization.]{Dual-Youla parametrization of the closed-loop set-up  with controller $\Controller$,  model set $\ModelSet[]$ and nominal plant model $\estimated\Plant$.}
\label{fig:lrmhinf:dualYoula}
\end{figure}

The parametrization of the plant model set $\ModelSet[]$ conforms to the dual-\YK{} framework~\citep{Hansen1989,Anderson1998} that parametrizes $\ModelSet[]$ in terms of  all plants $P$ that are stabilized by the controller $C$:
\begin{equation}
  \ModelSet[] 
    \isdef 
      \Set{
            \frac{\hat{N} + D_c \Delta}
                 {\hat{D} - N_c \Delta} 
          |
            \infnorm{\Delta} \leq \gamma
        }
  \label{eq:lrmhinf:dualYoulaModelSet}
  \text{,}
\end{equation}
where $C=N_c D_c^{-1}$ and $\estimated\Plant = \estimated{N}\estimated{D}^{-1}$ are decomposed as \gls{RCF} (see \figref{fig:lrmhinf:dualYoula}).
To estimate $\Delta$ and $\infnorm{\Delta}$, the signals $u_{\Delta}$ and $y_{\Delta}$ in~\figref{fig:lrmhinf:dualYoula} are required.
These can be computed from $u$ and $y$ directly~\citep{Anderson1998}:
\begin{align}
  u_{\Delta}(t) &= \left(\hat{D} + C \hat{N} \right)^{-1} \mat{C & \I} \mat{y(t)\\u(t)}\\
  y_{\Delta}(t) &= \left(D_c + \hat{P} N_c \right)^{-1} \mat{\I & -\hat{P}} \mat{y(t)\\u(t)}
\end{align}
In addition, $u_{\Delta}$ is noise free under standard assumptions~\citep{Hansen1989} and uncorrelated to $y_{\Delta}$. 
Hence the method of \secref{sec:lrmhinf:LPMHinf} applies directly.

The non-uniqueness of the \gls{RCF} can be exploited to satisfy additional conditions.
In view of the robust control criterion
\begin{equation}
  \Crit(\Plant,\Controller) 
    \isdef 
      \infnorm{W \ClosedLoop{\Plant,\Controller} V}
  \label{eq:lrmhinf:controlCrit}
  \text{,}
\end{equation}
the \glspl{RCF} are constructed such that
$
  \worstCase\Crit \left( \ModelSet[], \experimental\Controller \right)
  \leq
  \Crit \left( \estimated\Plant, \experimental\Controller \right)
  + \gamma
$
where $\worstCase\Crit(\ModelSet[],C) \isdef \sup_{P\in\ModelSet[]} \Crit(P,C)$~\citep{Oomen2012SIRP}.
% Obviously, $\Crit( \true\Plant, \experimental\Controller) \leq \worstCase\Crit ( \ModelSet[], \experimental\Controller )$ is guaranteed when $\true\Plant \in \ModelSet[]$.
I.e. even for a weighted control criterion \eqref{eq:lrmhinf:controlCrit}, there is no need to incorporate weights $W'$ and $V'$ into the estimation of the uncertainty bound as $\infnorm{W' \Delta V'}$.
In this chapter, an eighth-order $\estimated\Plant$~(\figref{fig:lrmhinf:avis-frf}) is estimated.
Some dynamics are left unmodeled and are hence part of $\Delta$~(\figref{fig:lrmhinf:avisMeas}).

\begin{figure}
 \centering
    \setlength{\figurewidth}{0.75\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
    \input{\thisDir/figs/avis-frf.tikz}
 \caption[\Glsentryname{FRF} and nominal model of \glsentryname{AVIS}.]{Measured \gls{FRF} \legref{m2t:plantFRF} and estimated parametric model $\hat{P}$ \legref{m2t:plantModel} of the \glsentryname{AVIS}.}
 \label{fig:lrmhinf:avis-frf}
\end{figure}

\subsection{Results}
\label{sec:lrmhinf:resultsAvis}
To estimate $\Delta(\omega_k)$ and $\infnorm{\Delta}$  using the proposed approach with $\lrm{6,2,2,2}$, a short estimation dataset is used.
This estimation dataset is sampled from a larger dataset that contains four times more excited frequency lines (and hence produces a four times more densely sampled \gls{FRF}).
The full dataset, i.e. including the bins not seen during the estimation phase, is used to validate the interpolation results.

The measured $\Delta$ is shown in \figref{fig:lrmhinf:avisMeas} for the whole frequency band and \figref{fig:lrmhinf:avisMeasZoom} for a frequency subrange containing $\omega_{\star}$.
Two aspects of the proposed method are examined.
First, the interpolation results for a continuous frequency range are validated.
Second, the peak amplitudes of $\Delta(\omega)$ are inspected as these are  indicators for $\infnorm{\Delta}$.

\begin{figure}[p]
 \centering
    \setlength{\figurewidth}{0.7\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
    \input{\thisDir/figs/avis-delta-full.tikz}
 \caption[$\Delta$ of the \glsentryname{AVIS}, estimated using local modeling.]{Measured (dual-Youla) $\Delta$ for the \gls{AVIS} using the \gls{LRM} and the proposed interpolation. The data in the rectangle is also shown in \figref{fig:lrmhinf:avisMeasZoom}.}
\label{fig:lrmhinf:avisMeas}
\end{figure}

\begin{figure}[p]
 \centering
    \setlength{\figurewidth}{0.7\columnwidth}
    \setlength{\figureheight}{0.68\figurewidth}
   \input{\thisDir/figs/avis4.tikz}
 \caption[$\Delta$ of the \glsentryname{AVIS}, estimated using local modeling (detail).]{Measured $\Delta$ for the \gls{AVIS} using the \gls{LRM}~\legref{leg:avis4-LRMi} and the proposed interpolation. Clearly, the \gls{LRM} leads to a higher peak value~\legref{leg:avis4-LRM-hinf}, especially at $328\unit{Hz}$. The validity of the LRM local parametric model is confirmed by the validation measurement at the dense frequency grid~\legref{leg:avis4-validation}, which reveals excellent interpolation properties and a similar peak value~\legref{leg:avis4-valid-hinf}.}
\label{fig:lrmhinf:avisMeasZoom}
\end{figure}

\paragraph*{Interpolation performance}
\label{sec:lrmhinf:avis-interpol}
\figref{fig:lrmhinf:avisMeas} and \figref{fig:lrmhinf:avisMeasZoom} show that the estimation and validation data for \gls{LRM} are generally in agreement.
In the frequency range shown in \figref{fig:lrmhinf:avisMeasZoom}, the relative difference between both is at most $2\%$.

\paragraph*{Peak value estimates}
\label{sec:lrmhinf:avis-peak-value}
Near $296\unit{Hz}$, a modest improvement of the peak estimate from $-15.3 \unit{dB}$ (at-grid) to $-14.0 \unit{dB}$ is obtained by the interpolation.
The estimate near $\omega_{\star} \approx 328\unit{Hz}$ is improved more substantially.
The proposed method \eqref{eq:lrmhinf:gammaInterpolOptim} yields $\gammaIntergrid=-2.5\unit{dB}$.
$\gamma_{\FRF}\approx -9.9\unit{dB}$ for the estimation data, which means that a $7.4\unit{dB}$ improvement is achieved by the proposed method.
This peak agrees well with the validation data, where the nearest (at-grid) value has an amplitude of $-3.2\unit{dB}$ (i.e. $8\%$ difference).

This suggests that the local rational models with interpolation enable accurate estimation of  $\abs{\Delta}$ and hence also $\infnorm{\Delta}$ even if the actual peak does not coincide with the discrete frequency grid.

\section{Conclusions}
\label{sec:lrmhinf:conclusion}
A local parametric \Hinf{} norm estimation technique for high performance, non-conservative robust control design is presented.
In this chapter, a new approach is presented that employs so-called local parametric \gls{LRM} models that lead to an enhanced estimate of $\infnorm{\Delta}$ of a \gls{SISO} error system by interpolating between neighboring local models.
It is also shown that the \gls{LPM} is not a worthwhile alternative to the \gls{LRM} to estimate $\infnorm{\Delta}$, at least for lightly-damped systems.

The technique is illustrated on a simulation example where the \gls{LRM}-based interpolation yields an accurate estimate of the $\Hinf{}$ norm.
It is observed that the measurement time is reduced by almost an order of magnitude compared with techniques that only examine $\Delta(\omega)$ on the \gls{DFT} frequency grid.
Using measurements on an \gls{AVIS}, it is illustrated that the interpolation-based results can substantially improve $\infnorm{\Delta}$ and/or reduce the measurement time four-fold.
Furthermore, the results are validated by a detailed validation measurement.
Ongoing research focuses on extending the technique to \gls{MIMO} systems.

\begin{subappendices}
  \input{\thisDir/ch04appendices.inc.tex}
\end{subappendices}
