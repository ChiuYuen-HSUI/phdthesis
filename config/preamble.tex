%\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}


\usepackage{xspace}
\usepackage{iftex}

\usepackage[natbib,
style=authortitle,
maxbibnames=10,
minbibnames=4,
maxcitenames=2,
citestyle=authoryear-comp,
backend=biber]{biblatex}
% \addbibresource{biblio/ownWork.bib}
% \addbibresource{biblio/references.bib}

% http://tex.stackexchange.com/questions/40798/how-do-i-get-et-al-to-appear-in-italics-when-using-textcite-or-citeauthor-w
\renewbibmacro*{name:andothers}{% Based on name:andothers from biblatex.def
  \ifboolexpr{
    test {\ifnumequal{\value{listcount}}{\value{liststop}}}
    and
    test \ifmorenames
  }
    {\ifnumgreater{\value{liststop}}{1}
       {\finalandcomma}
       {}%
     \andothersdelim\bibstring[\emph]{andothers}}
    {}}

% http://tex.stackexchange.com/questions/5660/redundancy-in-bib-file-conditionally-suppress-url-if-same-as-doi
% do not show URL if there is a DOI
\renewbibmacro*{doi+eprint+url}{%
  \iftoggle{bbx:doi}
    {
     \printfield{doi} 
    }{}%
  \newunit\newblock
  \iftoggle{bbx:eprint}
    {\usebibmacro{eprint}}
    {}%
  \newunit\newblock
  \iftoggle{bbx:url}
  {
   \iffieldundef{doi}{\usebibmacro{url+urldate}}{} 
  }
  {}
}

\usepackage{hyperref}

%% font configuration
\ifXeTeX
    \usepackage{fontspec}
    %\usepackage{mathspec}
    %% Theme 1
    \setsansfont{Avenir Next}[UprightFont={* Regular},BoldFont={* Medium},BoldItalicFont={* Medium Italic}]
    %\setmainfont{Merriweather}[Scale=MatchUppercase]
    \setmainfont{Alegreya}[SmallCapsFont={* SC}]
    \setmonofont{Source Code Pro}[UprightFont={*}, ItalicFont={* Light}, BoldFont={* Semibold},BoldItalicFont={* Black},Scale=MatchLowercase]
    
    %% Theme 2
    % \setmainfont{Source Serif Pro} %TODO: set SC font
    % \setsansfont{Source Sans Pro}
    % \setmonofont{Source Code Pro}[UprightFont={*}, ItalicFont={* Light}, BoldFont={* Semibold},BoldItalicFont={* Black}]

    % %% Theme 3
    % \setmainfont{Palatino}
    % \setsansfont{Helvetica}
    % \setmonofont{Source Code Pro}
\else
    \usepackage{fourier}
\fi


%% Graphics
\usepackage{graphicx}
\usepackage[usenames]{xcolor}
\usepackage{grffile}
\usepackage{tangocolors}

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage[caption=false,font=footnotesize]{subfig}


%% TikZ configuration
%TODO: put in own file
%TODO: use make instead
\usetikzlibrary{external}
\tikzexternalize[prefix = \thisDir/tikz/]
\tikzsetfigurename{\thisDir}
  \pgfplotsset{compat=newest}

  \newlength\figureheight
   \newlength\figurewidth


%% Version control
% http://tex.stackexchange.com/questions/127822/how-do-i-combine-the-vc-bundle-arara-and-sublime-text-2s-build-methods
\input{vc.tex}

%% page formatting
\setkomafont{pageheadfoot}{\color{gray}\sffamily}
\setkomafont{pagehead}{\color{gray}\sffamily}
\setkomafont{pagefoot}{\color{gray}\sffamily}
\addtokomafont{pagenumber}{\color{gray}\sffamily}

%% chapter formatting
\addtokomafont{chapterprefix}{\raggedleft}

\renewcommand*{\chapterformat}{%
\mbox{\color{gray}\chapappifchapterprefix{\nobreakspace}%
\scalebox{3}{\color{gray}\thechapter\autodot}\enskip}}
